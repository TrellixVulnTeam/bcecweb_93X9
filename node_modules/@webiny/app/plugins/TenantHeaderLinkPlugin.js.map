{"version":3,"sources":["../../src/plugins/TenantHeaderLinkPlugin.ts"],"names":["setContext","ApolloLinkPlugin","TenantHeaderLinkPlugin","tenant","name","query","URLSearchParams","location","search","get","window","__PS_RENDER_TENANT__","_","headers"],"mappings":";;;;;;;AAAA,SAASA,UAAT,QAA2B,qBAA3B;AACA,SAASC,gBAAT;;AAQA;AACA;AACA;AACA,WAAaC,sBAAb;AAAA;;AAAA;;AAGI,kCAAYC,MAAZ,EAA6B;AAAA;;AAAA;;AACzB;;AADyB;;AAEzB,UAAKC,IAAL,GAAY,oBAAZ;;AAEA,QAAI,CAACD,MAAL,EAAa;AACT,UAAME,KAAK,GAAG,IAAIC,eAAJ,CAAoBC,QAAQ,CAACC,MAA7B,CAAd;AACAL,MAAAA,MAAM,GAAGE,KAAK,CAACI,GAAN,CAAU,UAAV,KAAyBC,MAAM,CAACC,oBAAzC;AACH;;AAED,UAAKR,MAAL,GAAcA,MAAd;AATyB;AAU5B;;AAbL;AAAA;AAAA,WAeI,sBAAa;AAAA;;AACT,aAAOH,UAAU,CAAC,UAACY,CAAD,QAAoB;AAAA,YAAdC,OAAc,QAAdA,OAAc;;AAClC,YAAI,MAAI,CAACV,MAAT,EAAiB;AACb,iBAAO;AACHU,YAAAA,OAAO,kCACAA,OADA;AAEH,0BAAY,MAAI,CAACV;AAFd;AADJ,WAAP;AAMH;;AAED,eAAO;AAAEU,UAAAA,OAAO,EAAPA;AAAF,SAAP;AACH,OAXgB,CAAjB;AAYH;AA5BL;;AAAA;AAAA,EAA4CZ,gBAA5C","sourcesContent":["import { setContext } from \"apollo-link-context\";\nimport { ApolloLinkPlugin } from \"./ApolloLinkPlugin\";\n\ndeclare global {\n    interface Window {\n        __PS_RENDER_TENANT__: string;\n    }\n}\n\n/**\n * Append `x-tenant` header from URL query (necessary for prerendering service).\n */\nexport class TenantHeaderLinkPlugin extends ApolloLinkPlugin {\n    private tenant: string;\n\n    constructor(tenant?: string) {\n        super();\n        this.name = \"tenant-header-link\";\n\n        if (!tenant) {\n            const query = new URLSearchParams(location.search);\n            tenant = query.get(\"__tenant\") || window.__PS_RENDER_TENANT__;\n        }\n\n        this.tenant = tenant;\n    }\n\n    createLink() {\n        return setContext((_, { headers }) => {\n            if (this.tenant) {\n                return {\n                    headers: {\n                        ...headers,\n                        \"x-tenant\": this.tenant\n                    }\n                };\n            }\n\n            return { headers };\n        });\n    }\n}\n"],"file":"TenantHeaderLinkPlugin.js"}