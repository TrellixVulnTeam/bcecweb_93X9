{"version":3,"sources":["../../../src/plugins/graphql/formSettings.ts"],"names":["plugin","type","schema","typeDefs","resolvers","FbQuery","getSettings","_","args","formBuilder","settings","NotFoundResponse","Response","err","ErrorResponse","FbMutation","updateSettings","existingSettings","data"],"mappings":";;;;;;;AACA;;AAGA,MAAMA,MAA+C,GAAG;AACpDC,EAAAA,IAAI,EAAE,gBAD8C;AAEpDC,EAAAA,MAAM,EAAE;AACJC,IAAAA,QAAQ;AAAE;AAAe;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SApCY;AAqCJC,IAAAA,SAAS,EAAE;AACPC,MAAAA,OAAO,EAAE;AACL,cAAMC,WAAN,CAAkBC,CAAlB,EAAqBC,IAArB,EAA2B;AAAEC,UAAAA;AAAF,SAA3B,EAA4C;AACxC,cAAI;AACA,kBAAMC,QAAQ,GAAG,MAAMD,WAAW,CAACC,QAAZ,CAAqBJ,WAArB,EAAvB;;AACA,gBAAI,CAACI,QAAL,EAAe;AACX,qBAAO,IAAIC,2BAAJ,CAAsB,oCAAtB,CAAP;AACH;;AACD,mBAAO,IAAIC,mBAAJ,CAAaF,QAAb,CAAP;AACH,WAND,CAME,OAAOG,GAAP,EAAY;AACV,mBAAO,IAAIC,wBAAJ,CAAkBD,GAAlB,CAAP;AACH;AACJ;;AAXI,OADF;AAcPE,MAAAA,UAAU,EAAE;AACRC,QAAAA,cAAc,EAAE,OAAOT,CAAP,EAAUC,IAAV,EAAgB;AAAEC,UAAAA;AAAF,SAAhB,KAAoC;AAChD,cAAI;AACA,kBAAMQ,gBAAgB,GAAG,MAAMR,WAAW,CAACC,QAAZ,CAAqBJ,WAArB,EAA/B;;AAEA,gBAAI,CAACW,gBAAL,EAAuB;AACnB,qBAAO,IAAIN,2BAAJ,CAAsB,oCAAtB,CAAP;AACH;;AAED,kBAAMD,QAAQ,GAAG,MAAMD,WAAW,CAACC,QAAZ,CAAqBM,cAArB,CAAoCR,IAAI,CAACU,IAAzC,CAAvB;AACA,mBAAO,IAAIN,mBAAJ,CAAaF,QAAb,CAAP;AACH,WATD,CASE,OAAOG,GAAP,EAAY;AACV,mBAAO,IAAIC,wBAAJ,CAAkBD,GAAlB,CAAP;AACH;AACJ;AAdO;AAdL;AArCP;AAF4C,CAAxD;eAyEeb,M","sourcesContent":["import { GraphQLSchemaPlugin } from \"@webiny/handler-graphql/types\";\nimport { ErrorResponse, NotFoundResponse, Response } from \"@webiny/handler-graphql/responses\";\nimport { FormBuilderContext } from \"../../types\";\n\nconst plugin: GraphQLSchemaPlugin<FormBuilderContext> = {\n    type: \"graphql-schema\",\n    schema: {\n        typeDefs: /* GraphQL */ `\n            type FbReCaptchaSettings {\n                enabled: Boolean\n                siteKey: String\n                secretKey: String\n            }\n\n            input FbReCaptchaSettingsInput {\n                enabled: Boolean\n                siteKey: String\n                secretKey: String\n            }\n\n            type FbSettings {\n                domain: String\n                reCaptcha: FbReCaptchaSettings\n            }\n\n            type FbSettingsResponse {\n                data: FbSettings\n                error: FbError\n            }\n\n            input FbSettingsInput {\n                domain: String\n                reCaptcha: FbReCaptchaSettingsInput\n            }\n\n            extend type FbQuery {\n                getSettings: FbSettingsResponse\n            }\n\n            extend type FbMutation {\n                updateSettings(data: FbSettingsInput): FbSettingsResponse\n            }\n        `,\n        resolvers: {\n            FbQuery: {\n                async getSettings(_, args, { formBuilder }) {\n                    try {\n                        const settings = await formBuilder.settings.getSettings();\n                        if (!settings) {\n                            return new NotFoundResponse(`\"Form Builder\" settings not found!`);\n                        }\n                        return new Response(settings);\n                    } catch (err) {\n                        return new ErrorResponse(err);\n                    }\n                }\n            },\n            FbMutation: {\n                updateSettings: async (_, args, { formBuilder }) => {\n                    try {\n                        const existingSettings = await formBuilder.settings.getSettings();\n\n                        if (!existingSettings) {\n                            return new NotFoundResponse(`\"Form Builder\" settings not found!`);\n                        }\n\n                        const settings = await formBuilder.settings.updateSettings(args.data);\n                        return new Response(settings);\n                    } catch (err) {\n                        return new ErrorResponse(err);\n                    }\n                }\n            }\n        }\n    }\n};\n\nexport default plugin;\n"],"file":"formSettings.js"}