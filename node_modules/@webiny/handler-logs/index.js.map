{"version":3,"sources":["../src/index.ts"],"names":["consoleLog","console","log","logs","args","push","meta","functionName","process","env","AWS_LAMBDA_FUNCTION_NAME","type","apply","url","WEBINY_LOGS_FORWARD_URL","length","startsWith","method","headers","body","JSON","stringify"],"mappings":";;;;;;;;;AAAA;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAACC,GAA3B;AAEA,MAAMC,IAAI,GAAG,EAAb;;AACAF,OAAO,CAACC,GAAR,GAAc,CAAC,GAAGE,IAAJ,KAAa;AACvBD,EAAAA,IAAI,CAACE,IAAL,CAAU;AACND,IAAAA,IADM;AAENE,IAAAA,IAAI,EAAE;AACFC,MAAAA,YAAY,EAAEC,OAAO,CAACC,GAAR,CAAYC;AADxB;AAFA,GAAV;AAMAV,EAAAA,UAAU,CAAC,GAAGI,IAAJ,CAAV;AACH,CARD;;eAUe,OAAO;AAClBO,EAAAA,IAAI,EAAE,gBADY;;AAElB,QAAMC,KAAN,GAAc;AACV,UAAMC,GAAG,GAAGL,OAAO,CAACC,GAAR,CAAYK,uBAAxB;;AACA,QAAIX,IAAI,CAACY,MAAL,IAAe,OAAOF,GAAP,KAAe,QAA9B,IAA0CA,GAAG,CAACG,UAAJ,CAAe,MAAf,CAA9C,EAAsE;AAClE,YAAM,wBAAMH,GAAN,EAAW;AACbI,QAAAA,MAAM,EAAE,MADK;AAEbC,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX;AAEL,oCAA0B;AAFrB,SAFI;AAMbC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAelB,IAAf;AANO,OAAX,CAAN;AAQH;;AACDA,IAAAA,IAAI,CAACY,MAAL,GAAc,CAAd;AACH;;AAfiB,CAAP,C","sourcesContent":["import fetch from \"node-fetch\";\nconst consoleLog = console.log;\n\nconst logs = [];\nconsole.log = (...args) => {\n    logs.push({\n        args,\n        meta: {\n            functionName: process.env.AWS_LAMBDA_FUNCTION_NAME\n        }\n    });\n    consoleLog(...args);\n};\n\nexport default () => ({\n    type: \"handler-result\",\n    async apply() {\n        const url = process.env.WEBINY_LOGS_FORWARD_URL;\n        if (logs.length && typeof url === \"string\" && url.startsWith(\"http\")) {\n            await fetch(url, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"Bypass-Tunnel-Reminder\": \"1\"\n                },\n                body: JSON.stringify(logs)\n            });\n        }\n        logs.length = 0;\n    }\n});\n"],"file":"index.js"}