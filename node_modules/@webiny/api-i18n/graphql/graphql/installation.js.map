{"version":3,"sources":["../../../src/graphql/graphql/installation.ts"],"names":["plugin","type","name","schema","typeDefs","resolvers","I18NQuery","version","_","__","context","tenancy","i18n","getCurrentTenant","system","getVersion","I18NMutation","install","args","data","e","ErrorResponse","code","message","Response"],"mappings":";;;;;;;AAAA;;AAIA,MAAMA,MAAwC,GAAG;AAC7CC,EAAAA,IAAI,EAAE,gBADuC;AAE7CC,EAAAA,IAAI,EAAE,kCAFuC;AAG7CC,EAAAA,MAAM,EAAE;AACJC,IAAAA,QAAQ;AAAE;AAAe;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAfY;AAgBJC,IAAAA,SAAS,EAAE;AACPC,MAAAA,SAAS,EAAE;AACPC,QAAAA,OAAO,EAAE,OAAOC,CAAP,EAAUC,EAAV,EAAcC,OAAd,KAA0B;AAC/B,gBAAM;AAAEC,YAAAA,OAAF;AAAWC,YAAAA;AAAX,cAAoBF,OAA1B;;AACA,cAAI,CAACC,OAAO,CAACE,gBAAR,EAAL,EAAiC;AAC7B,mBAAO,IAAP;AACH;;AAED,iBAAOD,IAAI,CAACE,MAAL,CAAYC,UAAZ,EAAP;AACH;AARM,OADJ;AAWPC,MAAAA,YAAY,EAAE;AACVC,QAAAA,OAAO,EAAE,OAAOT,CAAP,EAAUU,IAAV,EAAgBR,OAAhB,KAA4B;AACjC,cAAI;AACA,kBAAMA,OAAO,CAACE,IAAR,CAAaE,MAAb,CAAoBG,OAApB,CAA4BC,IAAI,CAACC,IAAjC,CAAN;AACH,WAFD,CAEE,OAAOC,CAAP,EAAU;AACR,mBAAO,IAAIC,6BAAJ,CAAkB;AACrBC,cAAAA,IAAI,EAAEF,CAAC,CAACE,IADa;AAErBC,cAAAA,OAAO,EAAEH,CAAC,CAACG,OAFU;AAGrBJ,cAAAA,IAAI,EAAEC,CAAC,CAACD;AAHa,aAAlB,CAAP;AAKH;;AAED,iBAAO,IAAIK,wBAAJ,CAAa,IAAb,CAAP;AACH;AAbS;AAXP;AAhBP;AAHqC,CAAjD;eAiDexB,M","sourcesContent":["import { ErrorResponse, Response } from \"@webiny/handler-graphql\";\nimport { I18NContext } from \"~/types\";\nimport { GraphQLSchemaPlugin } from \"@webiny/handler-graphql/types\";\n\nconst plugin: GraphQLSchemaPlugin<I18NContext> = {\n    type: \"graphql-schema\",\n    name: \"graphql-schema-i18n-installation\",\n    schema: {\n        typeDefs: /* GraphQL */ `\n            input I18NInstallInput {\n                code: String!\n            }\n\n            extend type I18NQuery {\n                \"Get installed version\"\n                version: String\n            }\n\n            extend type I18NMutation {\n                \"Install I18N\"\n                install(data: I18NInstallInput!): I18NBooleanResponse\n            }\n        `,\n        resolvers: {\n            I18NQuery: {\n                version: async (_, __, context) => {\n                    const { tenancy, i18n } = context;\n                    if (!tenancy.getCurrentTenant()) {\n                        return null;\n                    }\n\n                    return i18n.system.getVersion();\n                }\n            },\n            I18NMutation: {\n                install: async (_, args, context) => {\n                    try {\n                        await context.i18n.system.install(args.data);\n                    } catch (e) {\n                        return new ErrorResponse({\n                            code: e.code,\n                            message: e.message,\n                            data: e.data\n                        });\n                    }\n\n                    return new Response(true);\n                }\n            }\n        }\n    }\n};\n\nexport default plugin;\n"],"file":"installation.js"}