{"version":3,"sources":["../../src/plugins/tenancy.tsx"],"names":["useEffect","TenantPlugin","useSecurity","useTenancy","tenant","onChange","setTenant","identity","off","setPermissions","permissions","access"],"mappings":"AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,SAASC,YAAT,QAA6B,0CAA7B;AACA,SAASC,WAAT,QAA4B,sBAA5B;AAGA,SAASC,UAAT,QAA2B,sCAA3B;AAMA,eAAe,IAAIF,YAAJ,CAAiB,YAAM;AAClC,oBAAwCE,UAAU,EAAlD;AAAA,MAAQC,MAAR,eAAQA,MAAR;AAAA,MAAgBC,QAAhB,eAAgBA,QAAhB;AAAA,MAA0BC,SAA1B,eAA0BA,SAA1B;;AACA,qBAAqBJ,WAAW,EAAhC;AAAA,MAAQK,QAAR,gBAAQA,QAAR;;AAEAP,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAMQ,GAAG,GAAGH,QAAQ,CAAC,UAAAD,MAAM,EAAI;AAC3BG,MAAAA,QAAQ,CAACE,cAAT,CAAwBL,MAAM,GAAGA,MAAM,CAACM,WAAV,GAAwB,EAAtD;AACH,KAFmB,CAApB;;AAIA,QAAI,CAACN,MAAL,EAAa;AACTE,MAAAA,SAAS,CAACC,QAAQ,CAACI,MAAT,CAAgB,CAAhB,CAAD,CAAT;AACH;;AAED,WAAO;AAAA,aAAMH,GAAG,EAAT;AAAA,KAAP;AACH,GAVQ,EAUN,EAVM,CAAT;AAYA,SAAO,IAAP;AACH,CAjBc,CAAf","sourcesContent":["import { useEffect } from \"react\";\nimport { TenantPlugin } from \"@webiny/app-tenancy/plugins/TenantPlugin\";\nimport { useSecurity } from \"@webiny/app-security\";\nimport { Tenant } from \"@webiny/app-tenancy/contexts/Tenancy\";\nimport { SecurityPermission } from \"@webiny/app-security/types\";\nimport { useTenancy } from \"@webiny/app-tenancy/hooks/useTenancy\";\n\ninterface TenantWithPermissions extends Tenant {\n    permissions: SecurityPermission[];\n}\n\nexport default new TenantPlugin(() => {\n    const { tenant, onChange, setTenant } = useTenancy<TenantWithPermissions>();\n    const { identity } = useSecurity();\n\n    useEffect(() => {\n        const off = onChange(tenant => {\n            identity.setPermissions(tenant ? tenant.permissions : []);\n        });\n\n        if (!tenant) {\n            setTenant(identity.access[0]);\n        }\n\n        return () => off();\n    }, []);\n\n    return null;\n});\n"],"file":"tenancy.js"}