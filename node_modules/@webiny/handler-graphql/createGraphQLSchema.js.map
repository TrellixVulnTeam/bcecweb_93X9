{"version":3,"sources":["../src/createGraphQLSchema.ts"],"names":["createGraphQLSchema","context","scalars","plugins","byType","map","item","scalar","typeDefs","name","join","resolvers","reduce","acc","s","JSON","JsonScalar","Long","LongScalar","RefInput","Number","NumberScalar","Any","AnyScalar","DateTime","DateTimeScalar","Date","DateScalar","Time","TimeScalar","gqlPlugins","i","length","plugin","push","schema"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AAIA;;;;;;AAWO,MAAMA,mBAAmB,GAAIC,OAAD,IAAmC;AAClE,QAAMC,OAAO,GAAGD,OAAO,CAACE,OAAR,CACXC,MADW,CACiB,gBADjB,EAEXC,GAFW,CAEPC,IAAI,IAAIA,IAAI,CAACC,MAFN,CAAhB;AAIA,QAAMC,QAAQ,GAAG,CACb,wBAAI;AACZ;AACA;AACA,cAAcN,OAAO,CAACG,GAAR,CAAYE,MAAM,IAAK,UAASA,MAAM,CAACE,IAAK,EAA5C,EAA+CC,IAA/C,CAAoD,GAApD,CAAyD;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAbqB,CAAjB;AAgBA,QAAMC,SAAS,GAAG,iCAEPT,OAAO,CAACU,MAAR,CAAe,CAACC,GAAD,EAAMC,CAAN,KAAY;AAC1BD,IAAAA,GAAG,CAACC,CAAC,CAACL,IAAH,CAAH,GAAcK,CAAd;AACA,WAAOD,GAAP;AACH,GAHE,EAGA,EAHA,CAFO;AAMVE,IAAAA,IAAI,EAAEC,wBANI;AAOVC,IAAAA,IAAI,EAAEC,wBAPI;AAQVC,IAAAA,QAAQ,EAARA,sBARU;AASVC,IAAAA,MAAM,EAAEC,oBATE;AAUVC,IAAAA,GAAG,EAAEC,iBAVK;AAWVC,IAAAA,QAAQ,EAAEC,4BAXA;AAYVC,IAAAA,IAAI,EAAEC,wBAZI;AAaVC,IAAAA,IAAI,EAAEC;AAbI,KAAlB;AAiBA,QAAMC,UAAU,GAAG7B,OAAO,CAACE,OAAR,CAAgBC,MAAhB,CAAuB,gBAAvB,CAAnB;;AACA,OAAK,IAAI2B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,UAAU,CAACE,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AACxC,UAAME,MAAM,GAAGH,UAAU,CAACC,CAAD,CAAzB;AACAvB,IAAAA,QAAQ,CAAC0B,IAAT,CAAcD,MAAM,CAACE,MAAP,CAAc3B,QAA5B;AACAG,IAAAA,SAAS,CAACuB,IAAV,CAAeD,MAAM,CAACE,MAAP,CAAcxB,SAA7B;AACH;;AAED,SAAO,kCAAqB;AACxBH,IAAAA,QADwB;AAExBG,IAAAA;AAFwB,GAArB,CAAP;AAIH,CAjDM","sourcesContent":["import gql from \"graphql-tag\";\nimport { makeExecutableSchema } from \"@graphql-tools/schema\";\nimport { GraphQLScalarPlugin } from \"./types\";\nimport { Context } from \"@webiny/handler/types\";\nimport { HttpContext } from \"@webiny/handler-http/types\";\nimport {\n    RefInput,\n    Number as NumberScalar,\n    Any as AnyScalar,\n    DateScalar,\n    DateTimeScalar,\n    JsonScalar,\n    TimeScalar,\n    LongScalar\n} from \"./builtInTypes\";\n\nexport const createGraphQLSchema = (context: Context<HttpContext>) => {\n    const scalars = context.plugins\n        .byType<GraphQLScalarPlugin>(\"graphql-scalar\")\n        .map(item => item.scalar);\n\n    const typeDefs = [\n        gql`\n            type Query\n            type Mutation\n            ${scalars.map(scalar => `scalar ${scalar.name}`).join(\" \")}\n            scalar JSON\n            scalar Long\n            scalar RefInput\n            scalar Number\n            scalar Any\n            scalar Date\n            scalar DateTime\n            scalar Time\n        `\n    ];\n\n    const resolvers = [\n        {\n            ...scalars.reduce((acc, s) => {\n                acc[s.name] = s;\n                return acc;\n            }, {}),\n            JSON: JsonScalar,\n            Long: LongScalar,\n            RefInput,\n            Number: NumberScalar,\n            Any: AnyScalar,\n            DateTime: DateTimeScalar,\n            Date: DateScalar,\n            Time: TimeScalar\n        }\n    ];\n\n    const gqlPlugins = context.plugins.byType(\"graphql-schema\");\n    for (let i = 0; i < gqlPlugins.length; i++) {\n        const plugin = gqlPlugins[i];\n        typeDefs.push(plugin.schema.typeDefs);\n        resolvers.push(plugin.schema.resolvers);\n    }\n\n    return makeExecutableSchema({\n        typeDefs,\n        resolvers\n    });\n};\n"],"file":"createGraphQLSchema.js"}