{"version":3,"sources":["../src/UILayout.tsx"],"names":["Plugin","plugins","UILayout","elementGetter","_getElement","layoutPlugins","byType","UILayoutPlugin","type","forEach","plugin","apply","flag","_grid","_layout","renderer","_renderer","id","sorter","sort","a","b","elementA","element","elementB","i","row","j","length","splice","item","width","lookFor","console","log","unshift","push","props","hasParentGrid","Error","layout","_apply"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { UIElement } from \"./UIElement\";\nimport { Plugin, plugins } from \"@webiny/plugins\";\n\ninterface LayoutItem {\n    element: string;\n    width: number;\n}\n\ninterface ElementGetter {\n    (elementId: string): UIElement<any>;\n}\n\ninterface Sorter {\n    (elementA: UIElement, elementB: UIElement): number;\n}\n\ninterface UILayoutRenderer {\n    (params: { layout: UILayout; props: any; hasParentGrid: boolean }): React.ReactElement;\n}\n\nexport class UILayout {\n    private _renderer: UILayoutRenderer;\n    private _grid = true;\n    private _layout: LayoutItem[][] = [];\n    private _getElement: ElementGetter;\n\n    constructor(elementGetter: ElementGetter) {\n        this._getElement = elementGetter;\n\n        const layoutPlugins = plugins.byType<UILayoutPlugin<any>>(UILayoutPlugin.type);\n        layoutPlugins.forEach(plugin => plugin.apply(this));\n    }\n\n    setGrid(flag: boolean) {\n        this._grid = flag;\n    }\n\n    getGrid() {\n        return this._grid;\n    }\n\n    getLayout() {\n        return this._layout;\n    }\n\n    setRenderer(renderer: UILayoutRenderer) {\n        this._renderer = renderer;\n    }\n\n    getElement(id) {\n        return this._getElement(id);\n    }\n\n    sort(sorter: Sorter) {\n        if (this._grid) {\n            return;\n        }\n\n        this._layout = this._layout.sort((a, b) => {\n            const elementA = this._getElement(a[0].element);\n            const elementB = this._getElement(b[0].element);\n\n            return sorter(elementA, elementB);\n        });\n    }\n\n    removeElement(element: UIElement<any>) {\n        for (let i = 0; i < this._layout.length; i++) {\n            const row = this._layout[i];\n            for (let j = 0; j < row.length; j++) {\n                if (row[j].element === element.id) {\n                    row.splice(j, 1);\n                    // Update spans on all items\n                    row.forEach(item => (item.width = 12 / row.length));\n                    return;\n                }\n            }\n        }\n    }\n\n    insertElementAbove(lookFor: UIElement<any>, element: UIElement<any>) {\n        for (let i = 0; i < this._layout.length; i++) {\n            const row = this._layout[i];\n            for (let j = 0; j < row.length; j++) {\n                if (row[j].element === lookFor.id) {\n                    this._layout.splice(i, 0, [{ element: element.id, width: 12 }]);\n                    return this;\n                }\n            }\n        }\n        return this;\n    }\n\n    insertElementBelow(lookFor: UIElement<any>, element: UIElement<any>) {\n        for (let i = 0; i < this._layout.length; i++) {\n            const row = this._layout[i];\n            for (let j = 0; j < row.length; j++) {\n                if (row[j].element === lookFor.id) {\n                    this._layout.splice(i + 1, 0, [{ element: element.id, width: 12 }]);\n                    return this;\n                }\n            }\n        }\n        return this;\n    }\n\n    insertElementAfter(lookFor: UIElement<any>, element: UIElement<any>) {\n        for (let i = 0; i < this._layout.length; i++) {\n            const row = this._layout[i];\n            for (let j = 0; j < row.length; j++) {\n                if (row[j].element === lookFor.id) {\n                    const width = 12 / (row.length + 1);\n                    row.splice(j + 1, 0, { element: element.id, width });\n                    // Update spans on all items\n                    row.forEach(item => (item.width = width));\n                    return this;\n                }\n            }\n        }\n        console.log(`[WARNING] Could not locate element \"${lookFor.id}\" in the layout!`);\n        return this;\n    }\n\n    insertElementBefore(lookFor: UIElement<any>, element: UIElement<any>) {\n        for (let i = 0; i < this._layout.length; i++) {\n            const row = this._layout[i];\n            for (let j = 0; j < row.length; j++) {\n                if (row[j].element === lookFor.id) {\n                    const width = 12 / (row.length + 1);\n                    // Insert new element to the left\n                    row.splice(j, 0, { element: element.id, width });\n                    // Update spans on all items\n                    row.forEach(item => (item.width = width));\n                    return this;\n                }\n            }\n        }\n        return this;\n    }\n\n    insertElementAtTheBeginning(element: UIElement<any>) {\n        this._layout.unshift([{ element: element.id, width: 12 }]);\n        return this;\n    }\n\n    insertElementAtTheEnd(element: UIElement<any>) {\n        this._layout.push([{ element: element.id, width: 12 }]);\n        return this;\n    }\n\n    render(props, hasParentGrid = false) {\n        if (!this._renderer) {\n            throw Error(\n                `UILayout needs a renderer! Register a UILayoutPlugin to configure a renderer.`\n            );\n        }\n\n        return this._renderer({ layout: this, props, hasParentGrid });\n    }\n}\n\ninterface ApplyFunction<TElement> {\n    (element: TElement): void;\n}\n\nexport class UILayoutPlugin<TLayout extends UILayout = UILayout> extends Plugin {\n    public static readonly type: string = \"UILayoutPlugin\";\n    private _apply: ApplyFunction<TLayout>;\n\n    constructor(apply: ApplyFunction<TLayout>) {\n        super();\n\n        this._apply = apply;\n    }\n\n    apply(element: TLayout) {\n        this._apply(element);\n    }\n}\n"],"file":"UILayout.js"}