{"version":3,"sources":["../../../src/plugins/definitions/ValueTransformPlugin.ts"],"names":["ValueTransformPlugin","Plugin","constructor","params","_params","fields","canTransform","field","includes","transform","WebinyError"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;AAiBO,MAAMA,oBAAN,SAAmCC,eAAnC,CAA0C;AAKtCC,EAAAA,WAAW,CAACC,MAAD,EAAiB;AAC/B;AAD+B;AAE/B,SAAKC,OAAL,mCACOD,MADP;AAEIE,MAAAA,MAAM,EAAE,gCAAaF,MAAM,CAACE,MAApB;AAFZ;AAIH;;AAEMC,EAAAA,YAAY,CAACC,KAAD,EAAyB;AACxC,QAAI,CAAC,KAAKH,OAAL,CAAaE,YAAlB,EAAgC;AAC5B,aAAO,KAAKF,OAAL,CAAaC,MAAb,CAAoBG,QAApB,CAA6BD,KAA7B,CAAP;AACH;;AACD,WAAO,KAAKH,OAAL,CAAaE,YAAb,CAA0BC,KAA1B,CAAP;AACH;;AAEME,EAAAA,SAAS,CAACN,MAAD,EAA+B;AAC3C,QAAI,CAAC,KAAKC,OAAL,CAAaK,SAAlB,EAA6B;AACzB,YAAM,IAAIC,cAAJ,CAAiB,oCAAjB,EAAsD,iBAAtD,EAAyE;AAC3EL,QAAAA,MAAM,EAAE,KAAKD,OAAL,CAAaC;AADsD,OAAzE,CAAN;AAGH;;AACD,WAAO,KAAKD,OAAL,CAAaK,SAAb,CAAuBN,MAAvB,CAAP;AACH;;AA3B4C;;;8BAApCH,oB,UACqB,0B","sourcesContent":["import { Plugin } from \"@webiny/plugins\";\nimport WebinyError from \"@webiny/error\";\nimport { assignFields } from \"./assignFields\";\n\nexport interface TransformParams {\n    value: any;\n}\nexport interface Transform {\n    (params: TransformParams): any;\n}\nexport interface CanTransform {\n    (field: string): boolean;\n}\nexport interface Params {\n    fields: string[];\n    transform: Transform;\n    canTransform?: CanTransform;\n}\n\nexport class ValueTransformPlugin extends Plugin {\n    public static readonly type = \"dynamodb.value.transform\";\n\n    private readonly _params: Params;\n\n    public constructor(params: Params) {\n        super();\n        this._params = {\n            ...params,\n            fields: assignFields(params.fields)\n        };\n    }\n\n    public canTransform(field: string): boolean {\n        if (!this._params.canTransform) {\n            return this._params.fields.includes(field);\n        }\n        return this._params.canTransform(field);\n    }\n\n    public transform(params: TransformParams): any {\n        if (!this._params.transform) {\n            throw new WebinyError(`Missing \"transform\" in the plugin.`, \"TRANSFORM_ERROR\", {\n                fields: this._params.fields\n            });\n        }\n        return this._params.transform(params);\n    }\n}\n"],"file":"ValueTransformPlugin.js"}