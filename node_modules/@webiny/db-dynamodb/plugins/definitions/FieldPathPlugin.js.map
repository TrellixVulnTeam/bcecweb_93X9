{"version":3,"sources":["../../../src/plugins/definitions/FieldPathPlugin.ts"],"names":["FieldPathPlugin","Plugin","constructor","params","_params","fields","canCreate","field","includes","createPath","WebinyError"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;AAiBO,MAAMA,eAAN,SAA8BC,eAA9B,CAAqC;AAIjCC,EAAAA,WAAW,CAACC,MAAD,EAAiB;AAC/B;AAD+B;AAE/B,SAAKC,OAAL,mCACOD,MADP;AAEIE,MAAAA,MAAM,EAAE,gCAAaF,MAAM,CAACE,MAApB;AAFZ;AAIH;;AAEMC,EAAAA,SAAS,CAACC,KAAD,EAAyB;AACrC,WAAO,KAAKH,OAAL,CAAaC,MAAb,CAAoBG,QAApB,CAA6BD,KAA7B,CAAP;AACH;;AAEME,EAAAA,UAAU,CAACF,KAAD,EAAwB;AACrC,QAAI,CAAC,KAAKH,OAAL,CAAaK,UAAlB,EAA8B;AAC1B,YAAM,IAAIC,cAAJ,CAAiB,qCAAjB,EAAuD,iBAAvD,EAA0E;AAC5EL,QAAAA,MAAM,EAAE,KAAKD,OAAL,CAAaC;AADuD,OAA1E,CAAN;AAGH;;AACD,WAAO,KAAKD,OAAL,CAAaK,UAAb,CAAwBF,KAAxB,CAAP;AACH;;AAvBuC;;;8BAA/BP,e,UACqB,qB","sourcesContent":["import { Plugin } from \"@webiny/plugins\";\nimport WebinyError from \"@webiny/error\";\nimport { assignFields } from \"./assignFields\";\n\nexport interface CreatePath {\n    (field: string): string;\n}\nexport interface Params {\n    /**\n     * Which field(s) is this plugin for.\n     */\n    fields: string | string[];\n    /**\n     * Create a path for given field.\n     * Field is passed because it can be a multi-field plugin.\n     */\n    createPath: CreatePath;\n}\n\nexport class FieldPathPlugin extends Plugin {\n    public static readonly type = \"dynamodb.value.path\";\n    private readonly _params: Omit<Params, \"fields\"> & { fields: string[] };\n\n    public constructor(params: Params) {\n        super();\n        this._params = {\n            ...params,\n            fields: assignFields(params.fields)\n        };\n    }\n\n    public canCreate(field: string): boolean {\n        return this._params.fields.includes(field);\n    }\n\n    public createPath(field: string): string {\n        if (!this._params.createPath) {\n            throw new WebinyError(`Missing \"createPath\" in the plugin.`, \"TRANSFORM_ERROR\", {\n                fields: this._params.fields\n            });\n        }\n        return this._params.createPath(field);\n    }\n}\n"],"file":"FieldPathPlugin.js"}