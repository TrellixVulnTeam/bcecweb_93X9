{"version":3,"sources":["../../../src/handlers/utils/createHandler.ts"],"names":["baseHeaders","handler","event","httpMethod","body","statusCode","headers","data","isBuffer","Buffer","toString","JSON","stringify","error","message","isBase64Encoded","e"],"mappings":";;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA,MAAMA,WAAW,GAAG;AAChB,iCAA+B,GADf;AAEhB,sCAAoC;AAFpB,CAApB;;eAKeC,OAAO,IAAI,MAAMC,KAAN,IAAe;AACrC,MAAIA,KAAK,CAACC,UAAN,KAAqB,SAAzB,EAAoC;AAChC,WAAO;AACHC,MAAAA,IAAI,EAAE,EADH;AAEHC,MAAAA,UAAU,EAAE,GAFT;AAGHC,MAAAA,OAAO,EAAEN;AAHN,KAAP;AAKH;;AAED,MAAI;AACA,UAAM;AAAEO,MAAAA,IAAF;AAAQF,MAAAA,UAAR;AAAoBC,MAAAA,OAAO,GAAG;AAA9B,QAAqC,MAAML,OAAO,CAACC,KAAD,CAAxD;AACA,UAAMM,QAAQ,GAAGC,MAAM,CAACD,QAAP,CAAgBD,IAAhB,CAAjB;AACA,UAAMH,IAAI,GAAGI,QAAQ,GACfD,IAAI,CAACG,QAAL,CAAc,QAAd,CADe,GAEfC,IAAI,CAACC,SAAL,CAAe;AACXC,MAAAA,KAAK,EAAE,KADI;AAEXN,MAAAA,IAFW;AAGXO,MAAAA,OAAO,EAAE;AAHE,KAAf,CAFN;AAQA,WAAO;AACHC,MAAAA,eAAe,EAAEP,QADd;AAEHH,MAAAA,UAAU,EAAEA,UAAU,IAAI,GAFvB;AAGHC,MAAAA,OAAO,kCAAON,WAAP,GAAuBM,OAAvB,CAHJ;AAIHF,MAAAA;AAJG,KAAP;AAMH,GAjBD,CAiBE,OAAOY,CAAP,EAAU;AACR,WAAO;AACHX,MAAAA,UAAU,EAAE,GADT;AAEHC,MAAAA,OAAO,EAAEN,WAFN;AAGHI,MAAAA,IAAI,EAAEO,IAAI,CAACC,SAAL,CAAe;AACjBC,QAAAA,KAAK,EAAE,IADU;AAEjBN,QAAAA,IAAI,EAAE,IAFW;AAGjBO,QAAAA,OAAO,EAAEE,CAAC,CAACF;AAHM,OAAf;AAHH,KAAP;AASH;AACJ,C","sourcesContent":["/**\n * We need to respond with adequate CORS headers.\n * @type {{\"Access-Control-Allow-Origin\": string, \"Access-Control-Allow-Credentials\": boolean}}\n */\nconst baseHeaders = {\n    \"Access-Control-Allow-Origin\": \"*\",\n    \"Access-Control-Allow-Credentials\": true\n};\n\nexport default handler => async event => {\n    if (event.httpMethod === \"OPTIONS\") {\n        return {\n            body: \"\",\n            statusCode: 204,\n            headers: baseHeaders\n        };\n    }\n\n    try {\n        const { data, statusCode, headers = {} } = await handler(event);\n        const isBuffer = Buffer.isBuffer(data);\n        const body = isBuffer\n            ? data.toString(\"base64\")\n            : JSON.stringify({\n                  error: false,\n                  data,\n                  message: null\n              });\n\n        return {\n            isBase64Encoded: isBuffer,\n            statusCode: statusCode || 200,\n            headers: { ...baseHeaders, ...headers },\n            body\n        };\n    } catch (e) {\n        return {\n            statusCode: 500,\n            headers: baseHeaders,\n            body: JSON.stringify({\n                error: true,\n                data: null,\n                message: e.message\n            })\n        };\n    }\n};\n"],"file":"createHandler.js"}