{"version":3,"sources":["../../../src/render/components/OEmbed.tsx"],"names":["React","useEffect","useCallback","css","appendSDK","props","sdk","global","element","url","window","Promise","resolve","script","document","createElement","type","src","encodeURI","setAttribute","onload","body","appendChild","initEmbed","init","node","getElementById","id","centerAlign","marginLeft","marginRight","renderEmbed","renderer","__html","then"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from \"react\";\nimport { css } from \"emotion\";\nimport { get } from \"lodash\";\n\nfunction appendSDK(props) {\n    const { sdk, global, element } = props;\n    const { url } = get(element, \"data.source\") || {};\n\n    if (!sdk || !url || window[global]) {\n        return Promise.resolve();\n    }\n\n    return new Promise(resolve => {\n        const script = document.createElement(\"script\");\n        script.type = \"text/javascript\";\n        script.src = encodeURI(sdk);\n        script.setAttribute(\"async\", \"\");\n        script.setAttribute(\"charset\", \"utf-8\");\n        script.onload = resolve;\n        document.body.appendChild(script);\n    });\n}\n\nfunction initEmbed(props) {\n    const { sdk, init, element } = props;\n    if (sdk && get(element, \"data.source.url\")) {\n        const node = document.getElementById(element.id);\n        if (typeof init === \"function\" && node) {\n            init({ props, node });\n        }\n    }\n}\n\nconst centerAlign = css({\n    \"*:first-of-type\": {\n        marginLeft: \"auto !important\",\n        marginRight: \"auto !important\"\n    }\n});\n\nexport default props => {\n    const { element, renderEmbed } = props;\n    const { url } = get(element, \"data.source\") || {};\n\n    const renderer = useCallback(() => {\n        if (typeof renderEmbed === \"function\") {\n            return renderEmbed(props);\n        }\n\n        return (\n            <div\n                id={element.id}\n                className={centerAlign}\n                dangerouslySetInnerHTML={{ __html: get(element, \"data.oembed.html\") || \"\" }}\n            />\n        );\n    }, [element, renderEmbed]);\n\n    useEffect(() => {\n        appendSDK(props).then(() => initEmbed(props));\n    });\n\n    return url ? renderer() : null;\n};\n"],"file":"OEmbed.js"}