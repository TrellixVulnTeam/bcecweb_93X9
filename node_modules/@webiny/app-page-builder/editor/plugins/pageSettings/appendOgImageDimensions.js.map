{"version":3,"sources":["../../../../src/editor/plugins/pageSettings/appendOgImageDimensions.ts"],"names":["OG_IMAGE_DIMENSIONS_PROPERTIES","data","value","setValue","meta","Array","isArray","settings","social","filter","item","includes","property","src","startsWith","Promise","resolve","reject","image","window","Image","onload","onerror","push","content","String","width","height"],"mappings":";;;;AAAA,IAAMA,8BAA8B,GAAG,CAAC,gBAAD,EAAmB,iBAAnB,CAAvC;AAGA;AAAA,uEAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAASC,YAAAA,IAAT,QAASA,IAAT,EAAeC,KAAf,QAAeA,KAAf,EAAsBC,QAAtB,QAAsBA,QAAtB;AACPC,YAAAA,IADO,GACA,EADA;;AAEX,gBAAIC,KAAK,CAACC,OAAN,CAAc,KAAIL,IAAJ,EAAU,sBAAV,CAAd,CAAJ,EAAsD;AAClDG,cAAAA,IAAI,sBAAOH,IAAI,CAACM,QAAL,CAAcC,MAAd,CAAqBJ,IAA5B,CAAJ;AACAA,cAAAA,IAAI,GAAGH,IAAI,CAACM,QAAL,CAAcC,MAAd,CAAqBJ,IAArB,CAA0BK,MAA1B,CAAiC,UAAAC,IAAI,EAAI;AAC5C,uBAAO,CAACV,8BAA8B,CAACW,QAA/B,CAAwCD,IAAI,CAACE,QAA7C,CAAR;AACH,eAFM,CAAP;AAGH;;AAPU,kBASP,CAACV,KAAD,IAAUA,KAAK,CAACW,GAAN,CAAUC,UAAV,CAAqB,OAArB,CATH;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,mBAac,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5D,kBAAMC,KAAK,GAAG,IAAIC,MAAM,CAACC,KAAX,EAAd;;AACAF,cAAAA,KAAK,CAACG,MAAN,GAAe,YAAY;AACvBL,gBAAAA,OAAO,CAACE,KAAD,CAAP;AACH,eAFD;;AAGAA,cAAAA,KAAK,CAACI,OAAN,GAAgBL,MAAhB;AACAC,cAAAA,KAAK,CAACL,GAAN,GAAYX,KAAK,CAACW,GAAlB;AACH,aAPwB,CAbd;;AAAA;AAaLK,YAAAA,KAbK;AAsBXd,YAAAA,IAAI,CAACmB,IAAL,CACI;AACIX,cAAAA,QAAQ,EAAE,gBADd;AAEIY,cAAAA,OAAO,EAAEC,MAAM,CAACP,KAAK,CAACQ,KAAP;AAFnB,aADJ,EAKI;AACId,cAAAA,QAAQ,EAAE,iBADd;AAEIY,cAAAA,OAAO,EAAEC,MAAM,CAACP,KAAK,CAACS,MAAP;AAFnB,aALJ;AAWAxB,YAAAA,QAAQ,CAAC,sBAAD,EAAyBC,IAAzB,CAAR;;AAjCW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAf;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["const OG_IMAGE_DIMENSIONS_PROPERTIES = [\"og:image:width\", \"og:image:height\"];\nimport { get } from \"lodash\";\n\nexport default async ({ data, value, setValue }) => {\n    let meta = [];\n    if (Array.isArray(get(data, \"settings.social.meta\"))) {\n        meta = [...data.settings.social.meta];\n        meta = data.settings.social.meta.filter(item => {\n            return !OG_IMAGE_DIMENSIONS_PROPERTIES.includes(item.property);\n        });\n    }\n\n    if (!value || value.src.startsWith(\"data:\")) {\n        return;\n    }\n\n    const image: any = await new Promise(function (resolve, reject) {\n        const image = new window.Image();\n        image.onload = function () {\n            resolve(image);\n        };\n        image.onerror = reject;\n        image.src = value.src;\n    });\n\n    meta.push(\n        {\n            property: \"og:image:width\",\n            content: String(image.width)\n        },\n        {\n            property: \"og:image:height\",\n            content: String(image.height)\n        }\n    );\n\n    setValue(\"settings.social.meta\", meta);\n};\n"],"file":"appendOgImageDimensions.js"}