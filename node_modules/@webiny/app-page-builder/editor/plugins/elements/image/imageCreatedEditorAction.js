import { plugins } from "@webiny/plugins";
var MAX_ELEMENT_FIND_RETRIES = 10;
var ELEMENT_FIND_RETRY_TIMEOUT = 100;

var clickOnImageWithRetries = function clickOnImageWithRetries(element, retryNumber) {
  var image = document.querySelector("#".concat(window.CSS.escape(element.id), " [data-role=\"select-image\"]"));

  if (image) {
    image.click();
    return;
  } else if (retryNumber >= MAX_ELEMENT_FIND_RETRIES) {
    return;
  }

  setTimeout(function () {
    return clickOnImageWithRetries(element, retryNumber + 1);
  }, ELEMENT_FIND_RETRY_TIMEOUT);
};

export var imageCreatedEditorAction = function imageCreatedEditorAction(state, meta, _ref) {
  var element = _ref.element,
      source = _ref.source;

  if (element.type !== "image") {
    return {};
  } // Check the source of the element (could be `saved` element which behaves differently from other elements)


  var imagePlugin = plugins.byType("pb-editor-page-element").find(function (pl) {
    return pl.elementType === source.type;
  });

  if (!imagePlugin) {
    return {};
  }

  var onCreate = imagePlugin.onCreate;

  if (!onCreate || onCreate !== "skip") {
    clickOnImageWithRetries(element, 0);
  }

  return {};
};
//# sourceMappingURL=imageCreatedEditorAction.js.map