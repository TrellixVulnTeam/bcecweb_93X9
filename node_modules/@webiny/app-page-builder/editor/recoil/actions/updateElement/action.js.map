{"version":3,"sources":["../../../../../src/editor/recoil/actions/updateElement/action.ts"],"names":["UpdateElementTreeActionEvent","SaveRevisionActionEvent","flattenElements","updateElementAction","state","client","element","history","triggerUpdateElementTree","actions","Error","push","flattenedContent","elements"],"mappings":"AAAA,SAASA,4BAAT,EAAuCC,uBAAvC,QAAsE,IAAtE;AAEA,SAASC,eAAT;AAGA,OAAO,IAAMC,mBAAqE,GAAG,SAAxEA,mBAAwE,CACjFC,KADiF,eAIhF;AAAA,MAFCC,MAED,QAFCA,MAED;AAAA,MADCC,OACD,SADCA,OACD;AAAA,MADUC,OACV,SADUA,OACV;AAAA,MADmBC,wBACnB,SADmBA,wBACnB;AACD,MAAMC,OAAO,GAAG,EAAhB;;AACA,MAAIF,OAAO,KAAK,IAAhB,EAAsB;AAClB,QAAI,CAACF,MAAL,EAAa;AACT,YAAM,IAAIK,KAAJ,CACF,wEADE,CAAN;AAGH;;AACDD,IAAAA,OAAO,CAACE,IAAR,CAAa,IAAIV,uBAAJ,EAAb;AACH,GATA,CAUD;;;AACA,MAAIO,wBAAJ,EAA8B;AAC1BC,IAAAA,OAAO,CAACE,IAAR,CAAa,IAAIX,4BAAJ,EAAb;AACH;;AAED,MAAMY,gBAAgB,GAAGV,eAAe,CAACI,OAAD,CAAxC;AAEA,SAAO;AACHF,IAAAA,KAAK,EAAE;AACHS,MAAAA,QAAQ,EAAED;AADP,KADJ;AAIHH,IAAAA,OAAO,EAAPA;AAJG,GAAP;AAMH,CA3BM","sourcesContent":["import { UpdateElementTreeActionEvent, SaveRevisionActionEvent } from \"..\";\nimport { EventActionCallable } from \"~/types\";\nimport { flattenElements } from \"~/editor/helpers\";\nimport { UpdateElementActionArgsType } from \"./types\";\n\nexport const updateElementAction: EventActionCallable<UpdateElementActionArgsType> = (\n    state,\n    { client },\n    { element, history, triggerUpdateElementTree }\n) => {\n    const actions = [];\n    if (history === true) {\n        if (!client) {\n            throw new Error(\n                \"You cannot save revision while updating if you do not pass client arg.\"\n            );\n        }\n        actions.push(new SaveRevisionActionEvent());\n    }\n    // Add \"UpdateElementTreeActionEvent\" to actions.\n    if (triggerUpdateElementTree) {\n        actions.push(new UpdateElementTreeActionEvent());\n    }\n\n    const flattenedContent = flattenElements(element);\n\n    return {\n        state: {\n            elements: flattenedContent\n        },\n        actions\n    };\n};\n"],"file":"action.js"}