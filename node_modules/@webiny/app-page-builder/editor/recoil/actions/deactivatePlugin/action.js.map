{"version":3,"sources":["../../../../../src/editor/recoil/actions/deactivatePlugin/action.ts"],"names":["plugins","removePlugin","state","name","plugin","byName","Error","activePluginsByType","type","filter","activePlugin","deactivatePluginByName","newState","deactivatePluginByType","deactivatePluginsByName","names","deactivatePluginAction","meta","pluginsState"],"mappings":";;;AAEA,SAASA,OAAT,QAAwB,iBAAxB;;AAGA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAyBC,IAAzB,EAA2D;AAC5E,MAAMC,MAAM,GAAGJ,OAAO,CAACK,MAAR,CAAeF,IAAf,CAAf;;AACA,MAAI,CAACC,MAAL,EAAa;AACT,UAAM,IAAIE,KAAJ,0CAA2CH,IAA3C,SAAN;AACH;;AACD,MAAMI,mBAAmB,GAAGL,KAAK,CAACE,MAAM,CAACI,IAAR,CAAL,IAAsB,EAAlD;AAEA,yCACON,KADP,2BAEKE,MAAM,CAACI,IAFZ,EAEmBD,mBAAmB,CAACE,MAApB,CAA2B,UAAAC,YAAY;AAAA,WAAIA,YAAY,CAACP,IAAb,KAAsBC,MAAM,CAACD,IAAjC;AAAA,GAAvC,CAFnB;AAIH,CAXD;;AAaA,IAAMQ,sBAAsB,GAAG,SAAzBA,sBAAyB,CAC3BT,KAD2B,EAE3BC,IAF2B,EAGgB;AAC3C,MAAMS,QAAQ,GAAGX,YAAY,CAACC,KAAD,EAAQC,IAAR,CAA7B;AAEA,SAAO;AACHD,IAAAA,KAAK,EAAE;AACHF,MAAAA,OAAO,EAAEY;AADN;AADJ,GAAP;AAKH,CAXD;;AAaA,IAAMC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAC3BX,KAD2B,EAE3BM,IAF2B,EAGgB;AAC3C,SAAO;AACHN,IAAAA,KAAK,EAAE;AACHF,MAAAA,OAAO,kCACAE,KADA,2BAEFM,IAFE,EAEK,EAFL;AADJ;AADJ,GAAP;AAQH,CAZD;;AAcA,IAAMM,uBAAuB,GAAG,SAA1BA,uBAA0B,CAC5BZ,KAD4B,EAE5Ba,KAF4B,EAGe;AAC3C,MAAIH,QAAQ,qBACLV,KADK,CAAZ;;AAD2C,6CAIxBa,KAJwB;AAAA;;AAAA;AAI3C,wDAA0B;AAAA,UAAfZ,IAAe;AACtBS,MAAAA,QAAQ,GAAGX,YAAY,CAACW,QAAD,EAAWT,IAAX,CAAvB;AACH;AAN0C;AAAA;AAAA;AAAA;AAAA;;AAO3C,SAAO;AACHD,IAAAA,KAAK,EAAE;AACHF,MAAAA,OAAO,EAAEY;AADN;AADJ,GAAP;AAKH,CAfD;;AAiBA,OAAO,IAAMI,sBAA2E,GAAG,SAA9EA,sBAA8E,OAEvFC,IAFuF,SAItF;AAAA,MAHUC,YAGV,QAHClB,OAGD;AAAA,MADCG,IACD,SADCA,IACD;AAAA,MADOY,KACP,SADOA,KACP;AAAA,MADcP,IACd,SADcA,IACd;;AACD,MAAIL,IAAJ,EAAU;AACN,WAAOQ,sBAAsB,CAACO,YAAD,EAAef,IAAf,CAA7B;AACH,GAFD,MAEO,IAAIK,IAAJ,EAAU;AACb,WAAOK,sBAAsB,CAACK,YAAD,EAAeV,IAAf,CAA7B;AACH,GAFM,MAEA,IAAIO,KAAJ,EAAW;AACd,WAAOD,uBAAuB,CAACI,YAAD,EAAeH,KAAf,CAA9B;AACH;;AACD,QAAM,IAAIT,KAAJ,CAAU,2EAAV,CAAN;AACH,CAbM","sourcesContent":["import { PluginsAtomType } from \"../../modules\";\nimport { DeactivatePluginActionArgsType } from \"./types\";\nimport { plugins } from \"@webiny/plugins\";\nimport { EventActionCallable, EventActionHandlerActionCallableResponse } from \"../../../../types\";\n\nconst removePlugin = (state: PluginsAtomType, name: string): PluginsAtomType => {\n    const plugin = plugins.byName(name);\n    if (!plugin) {\n        throw new Error(`There is no plugin with name \"${name}\".`);\n    }\n    const activePluginsByType = state[plugin.type] || [];\n\n    return {\n        ...state,\n        [plugin.type]: activePluginsByType.filter(activePlugin => activePlugin.name !== plugin.name)\n    };\n};\n\nconst deactivatePluginByName = (\n    state: PluginsAtomType,\n    name: string\n): EventActionHandlerActionCallableResponse => {\n    const newState = removePlugin(state, name);\n\n    return {\n        state: {\n            plugins: newState\n        }\n    };\n};\n\nconst deactivatePluginByType = (\n    state: PluginsAtomType,\n    type: string\n): EventActionHandlerActionCallableResponse => {\n    return {\n        state: {\n            plugins: {\n                ...state,\n                [type]: []\n            }\n        }\n    };\n};\n\nconst deactivatePluginsByName = (\n    state: PluginsAtomType,\n    names: string[]\n): EventActionHandlerActionCallableResponse => {\n    let newState = {\n        ...state\n    };\n    for (const name of names) {\n        newState = removePlugin(newState, name);\n    }\n    return {\n        state: {\n            plugins: newState\n        }\n    };\n};\n\nexport const deactivatePluginAction: EventActionCallable<DeactivatePluginActionArgsType> = (\n    { plugins: pluginsState },\n    meta,\n    { name, names, type }\n) => {\n    if (name) {\n        return deactivatePluginByName(pluginsState, name);\n    } else if (type) {\n        return deactivatePluginByType(pluginsState, type);\n    } else if (names) {\n        return deactivatePluginsByName(pluginsState, names);\n    }\n    throw new Error(\"You are trying to deactivate a plugin but did not pass info on which one.\");\n};\n"],"file":"action.js"}