{"version":3,"sources":["../../../src/editor/hooks/usePageSettings.ts"],"names":["useCallback","useEffect","useState","useRecoilValue","useSnackbar","useEventActionHandler","pageAtom","useKeyHandler","DeactivatePluginActionEvent","UpdatePageRevisionActionEvent","usePageSettings","activeSection","setActiveSection","eventActionHandler","pageData","showSnackbar","removeKeyHandler","addKeyHandler","closeSettings","trigger","name","savePage","pageValue","debounce","page","onFinish","e","preventDefault"],"mappings":";AAAA,SAASA,WAAT,EAAsBC,SAAtB,EAAiCC,QAAjC,QAAiD,OAAjD;AACA,SAASC,cAAT,QAA+B,QAA/B;AACA,SAASC,WAAT,QAA4B,qCAA5B;AACA,SAASC,qBAAT;AACA,SAASC,QAAT;AACA,SAASC,aAAT;AACA,SACIC,2BADJ,EAEIC,6BAFJ;AAOA,OAAO,SAASC,eAAT,GAA2B;AAC9B,kBAA0CR,QAAQ,CAAS,IAAT,CAAlD;AAAA;AAAA,MAAOS,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,MAAMC,kBAAkB,GAAGR,qBAAqB,EAAhD;AACA,MAAMS,QAAQ,GAAGX,cAAc,CAACG,QAAD,CAA/B;;AAEA,qBAAyBF,WAAW,EAApC;AAAA,MAAQW,YAAR,gBAAQA,YAAR;;AACA,uBAA4CR,aAAa,EAAzD;AAAA,MAAQS,gBAAR,kBAAQA,gBAAR;AAAA,MAA0BC,aAA1B,kBAA0BA,aAA1B;;AAEA,MAAMC,aAAa,GAAGlB,WAAW,CAAC,YAAM;AACpCa,IAAAA,kBAAkB,CAACM,OAAnB,CACI,IAAIX,2BAAJ,CAAgC;AAC5BY,MAAAA,IAAI,EAAE;AADsB,KAAhC,CADJ;AAKH,GANgC,EAM9B,EAN8B,CAAjC;AAQA,MAAMC,QAAQ,GAAGrB,WAAW,CAAC,UAAAsB,SAAS,EAAI;AACtCT,IAAAA,kBAAkB,CAACM,OAAnB,CACI,IAAIV,6BAAJ,CAAkC;AAC9Bc,MAAAA,QAAQ,EAAE,KADoB;AAE9BC,MAAAA,IAAI,EAAEF,SAFwB;AAG9BG,MAAAA,QAAQ,EAAE,oBAAM;AACZV,QAAAA,YAAY,CAAC,iBAAD,CAAZ;AACAG,QAAAA,aAAa;AAChB;AAN6B,KAAlC,CADJ;AAUH,GAX2B,EAWzB,EAXyB,CAA5B;AAaAjB,EAAAA,SAAS,CAAC,YAAM;AACZgB,IAAAA,aAAa,CAAC,QAAD,EAAW,UAAAS,CAAC,EAAI;AACzBA,MAAAA,CAAC,CAACC,cAAF;AACAT,MAAAA,aAAa;AAChB,KAHY,CAAb;AAKA,WAAO;AAAA,aAAMF,gBAAgB,CAAC,QAAD,CAAtB;AAAA,KAAP;AACH,GAPQ,CAAT;AASA,SAAO;AAAEJ,IAAAA,gBAAgB,EAAhBA,gBAAF;AAAoBD,IAAAA,aAAa,EAAbA,aAApB;AAAmCU,IAAAA,QAAQ,EAARA,QAAnC;AAA6CH,IAAAA,aAAa,EAAbA,aAA7C;AAA4DJ,IAAAA,QAAQ,EAARA;AAA5D,GAAP;AACH","sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\nimport { useRecoilValue } from \"recoil\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { useEventActionHandler } from \"~/editor/hooks/useEventActionHandler\";\nimport { pageAtom } from \"~/editor/recoil/modules\";\nimport { useKeyHandler } from \"~/editor/hooks/useKeyHandler\";\nimport {\n    DeactivatePluginActionEvent,\n    UpdatePageRevisionActionEvent\n} from \"~/editor/recoil/actions\";\n\nexport type UsePageSettings = ReturnType<typeof usePageSettings>;\n\nexport function usePageSettings() {\n    const [activeSection, setActiveSection] = useState<string>(null);\n    const eventActionHandler = useEventActionHandler();\n    const pageData = useRecoilValue(pageAtom);\n\n    const { showSnackbar } = useSnackbar();\n    const { removeKeyHandler, addKeyHandler } = useKeyHandler();\n\n    const closeSettings = useCallback(() => {\n        eventActionHandler.trigger(\n            new DeactivatePluginActionEvent({\n                name: \"pb-editor-page-settings-bar\"\n            })\n        );\n    }, []);\n\n    const savePage = useCallback(pageValue => {\n        eventActionHandler.trigger(\n            new UpdatePageRevisionActionEvent({\n                debounce: false,\n                page: pageValue,\n                onFinish: () => {\n                    showSnackbar(\"Settings saved!\");\n                    closeSettings();\n                }\n            })\n        );\n    }, []);\n\n    useEffect(() => {\n        addKeyHandler(\"escape\", e => {\n            e.preventDefault();\n            closeSettings();\n        });\n\n        return () => removeKeyHandler(\"escape\");\n    });\n\n    return { setActiveSection, activeSection, savePage, closeSettings, pageData };\n}\n"],"file":"usePageSettings.js"}