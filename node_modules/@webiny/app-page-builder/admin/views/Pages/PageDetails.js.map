{"version":3,"sources":["../../../../src/admin/views/Pages/PageDetails.tsx"],"names":["React","useQuery","useRouter","styled","renderPlugins","useSnackbar","GET_PAGE","ElementAnimation","ButtonDefault","ButtonIcon","EmptyView","i18n","t","ns","DetailsContainer","height","overflow","position","nav","backgroundColor","EmptyPageDetails","onCreatePage","canCreate","message","PageDetails","history","location","showSnackbar","query","URLSearchParams","search","pageId","get","getPageQuery","variables","id","skip","onCompleted","data","error","pageBuilder","getPage","push","page","refresh"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { useRouter } from \"@webiny/react-router\";\nimport styled from \"@emotion/styled\";\nimport { renderPlugins } from \"@webiny/app/plugins\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { GET_PAGE } from \"../../graphql/pages\";\nimport ElementAnimation from \"../../../render/components/ElementAnimation\";\nimport { ButtonDefault, ButtonIcon } from \"@webiny/ui/Button\";\nimport EmptyView from \"@webiny/app-admin/components/EmptyView\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport { ReactComponent as AddIcon } from \"@webiny/app-admin/assets/icons/add-18px.svg\";\n\nconst t = i18n.ns(\"app-page-builder/admin/views/pages/page-details\");\n\ndeclare global {\n    // eslint-disable-next-line\n    namespace JSX {\n        interface IntrinsicElements {\n            \"test-id\": {\n                children?: React.ReactNode;\n            };\n        }\n    }\n}\nconst DetailsContainer = styled(\"div\")({\n    height: \"calc(100% - 10px)\",\n    overflow: \"hidden\",\n    position: \"relative\",\n    nav: {\n        backgroundColor: \"var(--mdc-theme-surface)\"\n    }\n});\ntype EmptyPageDetailsProps = {\n    onCreatePage: (event?: React.SyntheticEvent) => void;\n    canCreate: boolean;\n};\nconst EmptyPageDetails = ({ onCreatePage, canCreate }: EmptyPageDetailsProps) => {\n    return (\n        <EmptyView\n            title={t`Click on the left side list to display page details {message} `({\n                message: canCreate ? \"or create a...\" : \"\"\n            })}\n            action={\n                canCreate ? (\n                    <ButtonDefault data-testid=\"new-record-button\" onClick={onCreatePage}>\n                        <ButtonIcon icon={<AddIcon />} /> {t`New Page`}\n                    </ButtonDefault>\n                ) : null\n            }\n        />\n    );\n};\ntype PageDetailsProps = {\n    onCreatePage: (event?: React.SyntheticEvent) => void;\n    canCreate: boolean;\n};\nconst PageDetails = ({ onCreatePage, canCreate }: PageDetailsProps) => {\n    const { history, location } = useRouter();\n    const { showSnackbar } = useSnackbar();\n\n    const query = new URLSearchParams(location.search);\n    const pageId = query.get(\"id\");\n\n    const getPageQuery = useQuery(GET_PAGE, {\n        variables: { id: pageId },\n        skip: !pageId,\n        onCompleted: data => {\n            const error = data?.pageBuilder?.getPage?.error;\n            if (error) {\n                history.push(\"/page-builder/pages\");\n                showSnackbar(error.message);\n            }\n        }\n    });\n\n    if (!pageId) {\n        return <EmptyPageDetails canCreate={canCreate} onCreatePage={onCreatePage} />;\n    }\n\n    const page = getPageQuery.data?.pageBuilder?.getPage?.data || {};\n\n    return (\n        <ElementAnimation>\n            {({ refresh }) => (\n                <DetailsContainer onScroll={refresh}>\n                    <test-id data-testid=\"pb-page-details\">\n                        {renderPlugins(\"pb-page-details\", {\n                            page,\n                            getPageQuery\n                        })}\n                    </test-id>\n                </DetailsContainer>\n            )}\n        </ElementAnimation>\n    );\n};\n\nexport default PageDetails;\n"],"file":"PageDetails.js"}