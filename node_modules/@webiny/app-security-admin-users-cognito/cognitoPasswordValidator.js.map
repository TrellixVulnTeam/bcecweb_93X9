{"version":3,"sources":["../src/cognitoPasswordValidator.ts"],"names":["ValidationError","createCognitoPasswordValidator","policy","value","requireSymbols","requireNumber","requireLowercase","requireUppercase","minimumLength","undefined","length","test","requireNumbers"],"mappings":"AAAA,SAASA,eAAT,QAAgC,oBAAhC;AAGA,OAAO,IAAMC,8BAA8B,GACvC,SADSA,8BACT,CAACC,MAAD;AAAA,SACA,UAACC,KAAD,EAAsB;AAClB,QAAI,CAACA,KAAL,EAAY;AACR;AACH;;AACDA,IAAAA,KAAK,GAAGA,KAAK,GAAG,EAAhB;AAEA,QAAMC,cAAc,GAAG,yCAAvB;AACA,QAAMC,aAAa,GAAG,OAAtB;AACA,QAAMC,gBAAgB,GAAG,OAAzB;AACA,QAAMC,gBAAgB,GAAG,OAAzB;;AAEA,QAAIL,MAAM,CAACM,aAAP,KAAyBC,SAAzB,IAAsCN,KAAK,CAACO,MAAN,GAAeR,MAAM,CAACM,aAAhE,EAA+E;AAC3E,YAAM,IAAIR,eAAJ,mCACyBE,MAAM,CAACM,aADhC,kBAAN;AAGH;;AAED,QAAIN,MAAM,CAACI,gBAAP,IAA2B,CAACA,gBAAgB,CAACK,IAAjB,CAAsBR,KAAtB,CAAhC,EAA8D;AAC1D,YAAM,IAAIH,eAAJ,CAAoB,2CAApB,CAAN;AACH;;AAED,QAAIE,MAAM,CAACU,cAAP,IAAyB,CAACP,aAAa,CAACM,IAAd,CAAmBR,KAAnB,CAA9B,EAAyD;AACrD,YAAM,IAAIH,eAAJ,CAAoB,8BAApB,CAAN;AACH;;AAED,QAAIE,MAAM,CAACK,gBAAP,IAA2B,CAACA,gBAAgB,CAACI,IAAjB,CAAsBR,KAAtB,CAAhC,EAA8D;AAC1D,YAAM,IAAIH,eAAJ,CAAoB,4CAApB,CAAN;AACH;;AAED,QAAIE,MAAM,CAACE,cAAP,IAAyB,CAACA,cAAc,CAACO,IAAf,CAAoBR,KAApB,CAA9B,EAA0D;AACtD,YAAM,IAAIH,eAAJ,CAAoB,yCAApB,CAAN;AACH;;AAED;AACH,GAnCD;AAAA,CADG","sourcesContent":["import { ValidationError } from \"@webiny/validation\";\nimport { PasswordPolicy } from \"./index\";\n\nexport const createCognitoPasswordValidator =\n    (policy: PasswordPolicy) =>\n    (value: any): void => {\n        if (!value) {\n            return;\n        }\n        value = value + \"\";\n\n        const requireSymbols = /([=+\\-^$*.\\[\\]{}()?\"!@#%&/,><':;|_~`])+/;\n        const requireNumber = /[0-9]/;\n        const requireLowercase = /[a-z]/;\n        const requireUppercase = /[A-Z]/;\n\n        if (policy.minimumLength !== undefined && value.length < policy.minimumLength) {\n            throw new ValidationError(\n                `Value requires at least ${policy.minimumLength} characters.`\n            );\n        }\n\n        if (policy.requireLowercase && !requireLowercase.test(value)) {\n            throw new ValidationError(\"Value must contain a lowercase character.\");\n        }\n\n        if (policy.requireNumbers && !requireNumber.test(value)) {\n            throw new ValidationError(\"Value must contain a number.\");\n        }\n\n        if (policy.requireUppercase && !requireUppercase.test(value)) {\n            throw new ValidationError(\"Value must contain an uppercase character.\");\n        }\n\n        if (policy.requireSymbols && !requireSymbols.test(value)) {\n            throw new ValidationError(\"Value must contain a special character.\");\n        }\n\n        return;\n    };\n"],"file":"cognitoPasswordValidator.js"}