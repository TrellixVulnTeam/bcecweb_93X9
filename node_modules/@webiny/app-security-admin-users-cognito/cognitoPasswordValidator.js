import { ValidationError } from "@webiny/validation";
export var createCognitoPasswordValidator = function createCognitoPasswordValidator(policy) {
  return function (value) {
    if (!value) {
      return;
    }

    value = value + "";
    var requireSymbols = /([=+\-^$*.\[\]{}()?"!@#%&/,><':;|_~`])+/;
    var requireNumber = /[0-9]/;
    var requireLowercase = /[a-z]/;
    var requireUppercase = /[A-Z]/;

    if (policy.minimumLength !== undefined && value.length < policy.minimumLength) {
      throw new ValidationError("Value requires at least ".concat(policy.minimumLength, " characters."));
    }

    if (policy.requireLowercase && !requireLowercase.test(value)) {
      throw new ValidationError("Value must contain a lowercase character.");
    }

    if (policy.requireNumbers && !requireNumber.test(value)) {
      throw new ValidationError("Value must contain a number.");
    }

    if (policy.requireUppercase && !requireUppercase.test(value)) {
      throw new ValidationError("Value must contain an uppercase character.");
    }

    if (policy.requireSymbols && !requireSymbols.test(value)) {
      throw new ValidationError("Value must contain a special character.");
    }

    return;
  };
};
//# sourceMappingURL=cognitoPasswordValidator.js.map