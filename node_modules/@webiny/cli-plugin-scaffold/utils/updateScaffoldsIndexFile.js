"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _tsMorph = require("ts-morph");

var _default = async ({
  scaffoldsIndexPath,
  importName,
  importPath
}) => {
  const project = new _tsMorph.Project();
  project.addSourceFileAtPath(scaffoldsIndexPath);
  const source = project.getSourceFileOrThrow(scaffoldsIndexPath);
  const existingImportDeclaration = source.getImportDeclaration(importPath);

  if (existingImportDeclaration) {
    throw new Error("Already exists.");
  }

  let index = 1;
  const importDeclarations = source.getImportDeclarations();

  if (importDeclarations.length) {
    const last = importDeclarations[importDeclarations.length - 1];
    index = last.getChildIndex() + 1;
  }

  source.insertImportDeclaration(index, {
    defaultImport: importName,
    moduleSpecifier: importPath
  });
  const pluginsArray = source.getFirstDescendant(node => _tsMorph.Node.isArrayLiteralExpression(node));
  pluginsArray.addElement(importName);
  await source.save();
};

exports.default = _default;
//# sourceMappingURL=updateScaffoldsIndexFile.js.map