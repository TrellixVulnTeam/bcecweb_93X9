{"version":3,"sources":["../../../../../../src/admin/plugins/formDetails/formSubmissions/FormSubmissionsList/FormSubmissionsList.tsx"],"names":["React","useState","TimeAgo","css","i18n","ListComponents","Tooltip","IconButton","Typography","Scrollbar","FormSubmissionDialog","Block","useSubmissions","t","namespace","TOP","blockWrapper","height","rightAlign","alignItems","FullName","submission","data","firstName","lastName","email","output","filter","Boolean","join","FormVersion","form","version","DataList","ListItem","ListItemMeta","ListItemText","ListTextOverline","FormSubmissionsList","loading","refresh","submissions","setSorter","nextPage","previousPage","hasPreviousPage","hasNextPage","exportSubmissions","exportInProgress","selectedFormSubmission","selectFormSubmission","setNextPage","setPreviousPage","multiSelectAll","sorters","pagination","map","submittedOn","meta","Date","id","ip","time"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport TimeAgo from \"timeago-react\";\nimport { css } from \"emotion\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport * as ListComponents from \"@webiny/ui/List\";\nimport { Tooltip } from \"@webiny/ui/Tooltip\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport { Typography } from \"@webiny/ui/Typography\";\nimport { Scrollbar } from \"@webiny/ui/Scrollbar\";\nimport FormSubmissionDialog from \"./FormSubmissionDialog\";\nimport { ReactComponent as ImportExport } from \"./icons/round-cloud_download-24px.svg\";\nimport Block from \"../Block\";\nimport useSubmissions from \"./useSubmissions\";\n\nconst t = i18n.namespace(\"FormsApp.FormsDataList\");\n\nconst TOP = 490;\nconst blockWrapper = css({\n    \"& .webiny-data-list__content\": {\n        height: `calc(100vh - ${TOP}px)`\n    }\n});\nconst rightAlign = css({\n    alignItems: \"flex-end !important\"\n});\n\nconst FullName = ({ submission }) => {\n    const {\n        data: { firstName, lastName, email }\n    } = submission;\n\n    const output = [firstName, lastName, email && `<${email}>`].filter(Boolean).join(\" \");\n    return <span>{output || \"N/A\"}</span>;\n};\n\nconst FormVersion = ({ submission }) => {\n    return <span>Form revision #{submission.form.version}</span>;\n};\n\ntype Props = {\n    form: {\n        id: string;\n    };\n};\n\nconst { DataList, ListItem, ListItemMeta, ListItemText, ListTextOverline } = ListComponents;\n\n// const sorters = [\n//     {\n//         label: t`Newest to oldest`,\n//         sorters: { createdOn: -1 }\n//     },\n//     {\n//         label: t`Oldest to newest`,\n//         sorters: { createdOn: 1 }\n//     }\n// ];\n\nexport const FormSubmissionsList = ({ form }: Props) => {\n    const {\n        loading,\n        refresh,\n        submissions,\n        setSorter,\n        nextPage,\n        previousPage,\n        hasPreviousPage,\n        hasNextPage,\n        exportSubmissions,\n        exportInProgress\n    } = useSubmissions(form);\n\n    const [selectedFormSubmission, selectFormSubmission] = useState(null);\n\n    return (\n        <>\n            <Block title=\"Submissions\" className={blockWrapper}>\n                <DataList\n                    loading={loading}\n                    refresh={refresh}\n                    data={submissions}\n                    setSorters={setSorter}\n                    pagination={{\n                        hasNextPage,\n                        hasPreviousPage,\n                        setNextPage: nextPage,\n                        setPreviousPage: previousPage\n                    }}\n                    multiSelectAll={null}\n                    multiSelectActions={\n                        <Tooltip content={t`Export all form submissions`} placement={\"bottom\"}>\n                            <IconButton\n                                icon={<ImportExport />}\n                                onClick={exportSubmissions}\n                                disabled={exportInProgress}\n                            />\n                        </Tooltip>\n                    }\n                    // sorters={sorters}\n                    showOptions={{\n                        multiSelectAll: false,\n                        sorters: true,\n                        refresh: true,\n                        pagination: true\n                    }}\n                >\n                    {({ data = [] }) => (\n                        <Scrollbar>\n                            {data.map(submission => {\n                                const submittedOn = submission.meta\n                                    ? submission.meta.submittedOn\n                                    : new Date();\n\n                                return (\n                                    <ListItem key={submission.id}>\n                                        <ListItemText\n                                            onClick={() => selectFormSubmission(submission)}\n                                        >\n                                            <FullName submission={submission} />\n                                            <ListTextOverline>\n                                                Visitor IP:{\" \"}\n                                                {(submission.meta && submission.meta.ip) || \"N/A\"}\n                                            </ListTextOverline>\n                                        </ListItemText>\n                                        <ListItemMeta className={rightAlign}>\n                                            <Typography use={\"subtitle2\"}>\n                                                {t`Submitted: {time}.`({\n                                                    time: <TimeAgo datetime={submittedOn} />\n                                                })}\n                                                <br />\n                                                <FormVersion submission={submission} />\n                                            </Typography>\n                                        </ListItemMeta>\n                                    </ListItem>\n                                );\n                            })}\n                        </Scrollbar>\n                    )}\n                </DataList>\n            </Block>\n            <FormSubmissionDialog\n                onClose={() => {\n                    selectFormSubmission(null);\n                }}\n                formSubmission={selectedFormSubmission}\n            />\n        </>\n    );\n};\n"],"file":"FormSubmissionsList.js"}