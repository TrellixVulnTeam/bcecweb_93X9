{"version":3,"sources":["../../../../../../src/admin/plugins/editor/formSettings/components/ReCaptchaSettingsDialog.tsx"],"names":["React","useMutation","Form","Input","useSnackbar","CircularProgress","Grid","Cell","UPDATE_FORMS_SETTINGS","useFormEditor","validation","i18n","t","namespace","Dialog","DialogTitle","DialogContent","DialogActions","ButtonDefault","ReCaptchaSettingsDialog","open","onClose","reCaptchaSettings","onSubmit","useState","loading","setLoading","setData","showSnackbar","updateFormsSettings","siteKey","secretKey","variables","data","reCaptcha","enabled","updateSettingsResponse","response","formBuilder","updateSettings","settings","error","message","Bind","submit","create"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { Form } from \"@webiny/form\";\nimport { Input } from \"@webiny/ui/Input\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { CircularProgress } from \"@webiny/ui/Progress\";\nimport { Grid, Cell } from \"@webiny/ui/Grid\";\nimport { UPDATE_FORMS_SETTINGS } from \"./graphql\";\nimport { useFormEditor } from \"../../../../components/FormEditor/Context\";\nimport { validation } from \"@webiny/validation\";\nimport { i18n } from \"@webiny/app/i18n\";\nconst t = i18n.namespace(\"Forms.ReCaptchaSettingsDialog\");\n\nimport { Dialog, DialogTitle, DialogContent, DialogActions } from \"@webiny/ui/Dialog\";\nimport { ButtonDefault } from \"@webiny/ui/Button\";\n\ntype Props = {\n    open: boolean;\n    onClose: () => void;\n    onSubmit: () => void;\n    reCaptchaSettings: any;\n};\n\nconst ReCaptchaSettingsDialog = ({ open, onClose, reCaptchaSettings, onSubmit }: Props) => {\n    const [loading, setLoading] = React.useState(false);\n    const { setData } = useFormEditor();\n    const { showSnackbar } = useSnackbar();\n\n    const [updateFormsSettings] = useMutation(UPDATE_FORMS_SETTINGS);\n\n    return (\n        <Dialog open={open} onClose={onClose}>\n            <Form\n                data={reCaptchaSettings}\n                onSubmit={async ({ siteKey, secretKey }) => {\n                    setLoading(true);\n                    const updateSettingsResponse = await updateFormsSettings({\n                        variables: {\n                            data: { reCaptcha: { enabled: true, siteKey, secretKey } }\n                        }\n                    });\n                    const response = updateSettingsResponse?.data?.formBuilder?.updateSettings;\n\n                    setData(data => {\n                        data.settings.reCaptcha.settings = {\n                            enabled: true,\n                            siteKey,\n                            secretKey\n                        };\n                        return data;\n                    });\n                    setLoading(false);\n\n                    if (response.error) {\n                        return showSnackbar(response.error.message);\n                    }\n\n                    onSubmit();\n                }}\n            >\n                {({ Bind, submit }) => {\n                    return (\n                        <>\n                            {loading && <CircularProgress />}\n                            <DialogTitle>{t`Edit Google reCAPTCHA settings`}</DialogTitle>\n                            <DialogContent>\n                                <Grid>\n                                    <Cell span={12}>\n                                        <Bind\n                                            name={\"siteKey\"}\n                                            validators={validation.create(\"required\")}\n                                        >\n                                            <Input\n                                                label={\"Site key\"}\n                                                description={\n                                                    <>\n                                                        A v2 Tickbox site key.{\" \"}\n                                                        <a\n                                                            href=\"https://www.google.com/recaptcha/admin\"\n                                                            target={\"_blank\"}\n                                                            rel=\"noopener noreferrer\"\n                                                        >\n                                                            Don&apos;t have a site key?\n                                                        </a>\n                                                    </>\n                                                }\n                                            />\n                                        </Bind>\n                                    </Cell>\n                                    <Cell span={12}>\n                                        <Bind\n                                            name={\"secretKey\"}\n                                            validators={validation.create(\"required\")}\n                                        >\n                                            <Input\n                                                label={\"Secret key\"}\n                                                description={\n                                                    <>\n                                                        A v2 Tickbox secret key.{\" \"}\n                                                        <a\n                                                            href=\"https://www.google.com/recaptcha/admin\"\n                                                            target={\"_blank\"}\n                                                            rel=\"noopener noreferrer\"\n                                                        >\n                                                            Don&apos;t have a site key?\n                                                        </a>\n                                                    </>\n                                                }\n                                            />\n                                        </Bind>\n                                    </Cell>\n                                </Grid>\n                            </DialogContent>\n                            <DialogActions>\n                                <ButtonDefault\n                                    onClick={submit}\n                                >{t`Enable Google reCAPTCHA`}</ButtonDefault>\n                            </DialogActions>\n                        </>\n                    );\n                }}\n            </Form>\n        </Dialog>\n    );\n};\n\nexport default ReCaptchaSettingsDialog;\n"],"file":"ReCaptchaSettingsDialog.js"}