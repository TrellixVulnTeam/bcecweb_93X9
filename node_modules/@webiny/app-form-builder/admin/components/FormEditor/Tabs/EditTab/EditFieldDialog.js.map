{"version":3,"sources":["../../../../../../src/admin/components/FormEditor/Tabs/EditTab/EditFieldDialog.tsx"],"names":["React","useState","useEffect","useCallback","css","styled","Dialog","DialogContent","DialogTitle","DialogCancel","DialogActions","DialogButton","Form","plugins","Tabs","Tab","GeneralTab","ValidatorsTab","FieldTypeSelector","i18n","t","namespace","useFormEditor","dialogBody","width","height","FbFormModelFieldList","display","justifyContent","alignItems","flexWrap","paddingTop","backgroundColor","EditFieldDialog","field","onSubmit","props","current","setCurrent","isNewField","setIsNewField","screen","setScreen","getFieldPlugin","_id","type","onClose","undefined","render","headerTitle","fieldPlugin","name","fieldTypeLabel","label","form","Array","isArray","validators","length","submit","byType","filter","pl","group","map","newCurrent","createField","fieldId","helpText"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport { cloneDeep } from \"lodash\";\nimport { css } from \"emotion\";\nimport styled from \"@emotion/styled\";\nimport {\n    Dialog,\n    DialogContent,\n    DialogTitle,\n    DialogCancel,\n    DialogActions,\n    DialogButton\n} from \"@webiny/ui/Dialog\";\nimport { Form } from \"@webiny/form\";\nimport { plugins } from \"@webiny/plugins\";\nimport { Tabs, Tab } from \"@webiny/ui/Tabs\";\nimport GeneralTab from \"./EditFieldDialog/GeneralTab\";\nimport ValidatorsTab from \"./EditFieldDialog/ValidatorsTab\";\nimport FieldTypeSelector from \"./EditFieldDialog/FieldTypeSelector\";\nimport { i18n } from \"@webiny/app/i18n\";\nconst t = i18n.namespace(\"FormEditor.EditFieldDialog\");\nimport { useFormEditor } from \"../../Context\";\nimport { FbBuilderFieldPlugin, FbFormModelField } from \"../../../../../types\";\n\nconst dialogBody = css({\n    \"&.webiny-ui-dialog__content\": {\n        width: 875,\n        height: 450\n    }\n});\n\nconst FbFormModelFieldList = styled(\"div\")({\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    flexWrap: \"wrap\",\n    paddingTop: 25,\n    backgroundColor: \"var(--mdc-theme-background) !important\"\n});\n\ntype EditFieldDialogProps = {\n    field: FbFormModelField;\n    onClose: Function;\n    onSubmit: (data: any) => void;\n};\n\nconst EditFieldDialog = ({ field, onSubmit, ...props }: EditFieldDialogProps) => {\n    const [current, setCurrent] = useState(null);\n    const [isNewField, setIsNewField] = useState<boolean>(false);\n    const [screen, setScreen] = useState<string>();\n\n    const { getFieldPlugin } = useFormEditor();\n\n    useEffect(() => {\n        setCurrent(cloneDeep(field));\n        if (field) {\n            setIsNewField(!field._id);\n            setScreen(field.type ? \"fieldOptions\" : \"fieldType\");\n        }\n    }, [field]);\n\n    const onClose = useCallback(() => {\n        setCurrent(null);\n        props.onClose();\n    }, undefined);\n\n    let render = null;\n    let headerTitle = t`Field Settings`;\n\n    if (current) {\n        const fieldPlugin = getFieldPlugin({ name: current.name });\n        if (fieldPlugin) {\n            headerTitle = t`Field Settings - {fieldTypeLabel}`({\n                fieldTypeLabel: fieldPlugin.field.label\n            });\n        }\n\n        switch (screen) {\n            case \"fieldOptions\": {\n                render = (\n                    <Form data={current} onSubmit={onSubmit}>\n                        {form => (\n                            <>\n                                <DialogContent className={dialogBody}>\n                                    <Tabs>\n                                        <Tab label={t`General`}>\n                                            <GeneralTab form={form} field={current} />\n                                        </Tab>\n                                        {Array.isArray(fieldPlugin.field.validators) &&\n                                            fieldPlugin.field.validators.length > 0 && (\n                                                <Tab label={\"Validators\"}>\n                                                    <ValidatorsTab form={form} field={current} />\n                                                </Tab>\n                                            )}\n                                    </Tabs>\n                                </DialogContent>\n                                <DialogActions\n                                    style={{\n                                        justifyContent: isNewField ? \"space-between\" : \"flex-end\"\n                                    }}\n                                >\n                                    {isNewField && (\n                                        <DialogButton\n                                            onClick={() => setScreen(\"fieldType\")}\n                                        >{t`Go back`}</DialogButton>\n                                    )}\n                                    <div>\n                                        <DialogButton onClick={onClose}>{t`Cancel`}</DialogButton>\n                                        <DialogButton onClick={form.submit}>{t`Save`}</DialogButton>\n                                    </div>\n                                </DialogActions>\n                            </>\n                        )}\n                    </Form>\n                );\n                break;\n            }\n            default:\n                render = (\n                    <>\n                        <DialogContent className={dialogBody}>\n                            <FbFormModelFieldList>\n                                {plugins\n                                    .byType<FbBuilderFieldPlugin>(\"form-editor-field-type\")\n                                    .filter(pl => !pl.field.group)\n                                    .map(pl => (\n                                        <FieldTypeSelector\n                                            key={pl.name}\n                                            fieldType={pl.field}\n                                            onClick={() => {\n                                                const newCurrent: any = pl.field.createField();\n                                                if (current) {\n                                                    // User edited existing field, that's why we still want to\n                                                    // keep a couple of previous values.\n                                                    const { _id, label, fieldId, helpText } =\n                                                        current;\n                                                    newCurrent._id = _id;\n                                                    newCurrent.label = label;\n                                                    newCurrent.fieldId = fieldId;\n                                                    newCurrent.helpText = helpText;\n                                                }\n                                                setCurrent(newCurrent);\n                                                setScreen(\"fieldOptions\");\n                                            }}\n                                        />\n                                    ))}\n                            </FbFormModelFieldList>\n                        </DialogContent>\n                        <DialogActions>\n                            <DialogCancel onClick={onClose}>{t`Cancel`}</DialogCancel>\n                        </DialogActions>\n                    </>\n                );\n        }\n    }\n\n    return (\n        <Dialog preventOutsideDismiss={true} open={!!current} onClose={onClose}>\n            <DialogTitle>{headerTitle}</DialogTitle>\n            {render}\n        </Dialog>\n    );\n};\n\nexport default EditFieldDialog;\n"],"file":"EditFieldDialog.js"}