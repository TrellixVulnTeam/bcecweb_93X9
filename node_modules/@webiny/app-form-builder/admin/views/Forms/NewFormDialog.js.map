{"version":3,"sources":["../../../../src/admin/views/Forms/NewFormDialog.tsx"],"names":["React","css","useRouter","useMutation","Form","Input","CREATE_FORM","useSnackbar","CircularProgress","i18n","t","namespace","Dialog","DialogTitle","DialogContent","DialogActions","ButtonDefault","addFormToListCache","narrowDialog","width","minWidth","NewFormDialog","open","onClose","useState","loading","setLoading","showSnackbar","history","create","formData","variables","update","cache","data","formBuilder","form","revision","error","message","push","encodeURIComponent","id","Bind","submit"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { css } from \"emotion\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { Form } from \"@webiny/form\";\nimport { Input } from \"@webiny/ui/Input\";\nimport { CREATE_FORM } from \"../../graphql\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { CircularProgress } from \"@webiny/ui/Progress\";\n\nimport { i18n } from \"@webiny/app/i18n\";\nconst t = i18n.namespace(\"Forms.NewFormDialog\");\n\nimport {\n    Dialog,\n    DialogTitle,\n    DialogContent,\n    DialogActions,\n    DialogOnClose\n} from \"@webiny/ui/Dialog\";\nimport { ButtonDefault } from \"@webiny/ui/Button\";\nimport { addFormToListCache } from \"../cache\";\n\nconst narrowDialog = css({\n    \".mdc-dialog__surface\": {\n        width: 400,\n        minWidth: 400\n    }\n});\n\nexport type NewFormDialogProps = {\n    open: boolean;\n    onClose: DialogOnClose;\n};\n\nconst NewFormDialog: React.FC<NewFormDialogProps> = ({ open, onClose }) => {\n    const [loading, setLoading] = React.useState(false);\n    const { showSnackbar } = useSnackbar();\n    const { history } = useRouter();\n\n    const [create] = useMutation(CREATE_FORM);\n\n    return (\n        <Dialog\n            open={open}\n            onClose={onClose}\n            className={narrowDialog}\n            data-testid=\"fb-new-form-modal\"\n        >\n            <Form\n                onSubmit={async formData => {\n                    setLoading(true);\n\n                    await create({\n                        variables: formData,\n                        update(cache, { data }) {\n                            const { data: revision, error } = data.formBuilder.form;\n\n                            if (error) {\n                                setLoading(false);\n                                return showSnackbar(error.message);\n                            }\n\n                            addFormToListCache(cache, revision);\n\n                            history.push(`/form-builder/forms/${encodeURIComponent(revision.id)}`);\n                        }\n                    });\n                }}\n            >\n                {({ Bind, submit }) => (\n                    <>\n                        {loading && <CircularProgress label={\"Creating form...\"} />}\n                        <DialogTitle>{t`New form`}</DialogTitle>\n                        <DialogContent>\n                            <Bind name={\"name\"}>\n                                <Input placeholder={\"Enter a name for your new form\"} />\n                            </Bind>\n                        </DialogContent>\n                        <DialogActions>\n                            <ButtonDefault onClick={submit}>+ {t`Create`}</ButtonDefault>\n                        </DialogActions>\n                    </>\n                )}\n            </Form>\n        </Dialog>\n    );\n};\n\nexport default NewFormDialog;\n"],"file":"NewFormDialog.js"}