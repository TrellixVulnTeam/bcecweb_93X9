"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _apiSecurity = require("@webiny/api-security");

var _default = (identity, permission, entity, entityField = "createdBy") => {
  // If user can only manage own records, let's check if he owns the loaded one.
  if ((permission === null || permission === void 0 ? void 0 : permission.own) === true) {
    if (entity[entityField].id !== identity.id) {
      throw new _apiSecurity.NotAuthorizedError();
    }
  }
};

exports.default = _default;
//# sourceMappingURL=checkOwnPermissions.js.map