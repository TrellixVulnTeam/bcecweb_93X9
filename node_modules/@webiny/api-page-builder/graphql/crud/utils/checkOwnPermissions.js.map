{"version":3,"sources":["../../../../src/graphql/crud/utils/checkOwnPermissions.ts"],"names":["identity","permission","entity","entityField","own","id","NotAuthorizedError"],"mappings":";;;;;;;AAAA;;eAEe,CACXA,QADW,EAEXC,UAFW,EAGXC,MAHW,EAIXC,WAAW,GAAG,WAJH,KAKJ;AACP;AACA,MAAI,CAAAF,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAEG,GAAZ,MAAoB,IAAxB,EAA8B;AAC1B,QAAIF,MAAM,CAACC,WAAD,CAAN,CAAoBE,EAApB,KAA2BL,QAAQ,CAACK,EAAxC,EAA4C;AACxC,YAAM,IAAIC,+BAAJ,EAAN;AACH;AACJ;AACJ,C","sourcesContent":["import { NotAuthorizedError, SecurityIdentity } from \"@webiny/api-security\";\n\nexport default (\n    identity: SecurityIdentity,\n    permission: Record<string, any>,\n    entity: Record<string, any>,\n    entityField = \"createdBy\"\n): void => {\n    // If user can only manage own records, let's check if he owns the loaded one.\n    if (permission?.own === true) {\n        if (entity[entityField].id !== identity.id) {\n            throw new NotAuthorizedError();\n        }\n    }\n};\n"],"file":"checkOwnPermissions.js"}