{"version":3,"sources":["../../../../src/graphql/crud/utils/defaults.ts"],"names":["db","table","process","env","DB_TABLE_PAGE_BUILDER","keys","primary","unique","name","fields","esDb","DB_TABLE_ELASTICSEARCH","es","context","tenant","tenancy","getCurrentTenant","Error","sharedIndex","ELASTICSEARCH_SHARED_INDEXES","index","id","prefix","ELASTIC_SEARCH_INDEX_PREFIX"],"mappings":";;;;;;eAEe;AACXA,EAAAA,EAAE,EAAE;AACAC,IAAAA,KAAK,EAAEC,OAAO,CAACC,GAAR,CAAYC,qBADnB;AAEAC,IAAAA,IAAI,EAAE,CACF;AACIC,MAAAA,OAAO,EAAE,IADb;AAEIC,MAAAA,MAAM,EAAE,IAFZ;AAGIC,MAAAA,IAAI,EAAE,SAHV;AAIIC,MAAAA,MAAM,EAAE,CAAC;AAAED,QAAAA,IAAI,EAAE;AAAR,OAAD,EAAiB;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAAjB;AAJZ,KADE;AAFN,GADO;AAYXE,EAAAA,IAAI,EAAE;AACFT,IAAAA,KAAK,EAAEC,OAAO,CAACC,GAAR,CAAYQ,sBADjB;AAEFN,IAAAA,IAAI,EAAE,CACF;AACIC,MAAAA,OAAO,EAAE,IADb;AAEIC,MAAAA,MAAM,EAAE,IAFZ;AAGIC,MAAAA,IAAI,EAAE,SAHV;AAIIC,MAAAA,MAAM,EAAE,CAAC;AAAED,QAAAA,IAAI,EAAE;AAAR,OAAD,EAAiB;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAAjB;AAJZ,KADE;AAFJ,GAZK;;AAuBXI,EAAAA,EAAE,CAACC,OAAD,EAAqB;AACnB,UAAMC,MAAM,GAAGD,OAAO,CAACE,OAAR,CAAgBC,gBAAhB,EAAf;;AACA,QAAI,CAACF,MAAL,EAAa;AACT,YAAM,IAAIG,KAAJ,CAAU,iBAAV,CAAN;AACH;;AAED,UAAMC,WAAW,GAAGhB,OAAO,CAACC,GAAR,CAAYgB,4BAAZ,KAA6C,MAAjE;AACA,UAAMC,KAAK,GAAI,GAAEF,WAAW,GAAG,MAAH,GAAYJ,MAAM,CAACO,EAAG,eAAlD;AAEA,UAAMC,MAAM,GAAGpB,OAAO,CAACC,GAAR,CAAYoB,2BAA3B;;AACA,QAAID,MAAJ,EAAY;AACR,aAAO;AAAEF,QAAAA,KAAK,EAAEE,MAAM,GAAGF;AAAlB,OAAP;AACH;;AACD,WAAO;AAAEA,MAAAA;AAAF,KAAP;AACH;;AArCU,C","sourcesContent":["import { PbContext } from \"../../types\";\n\nexport default {\n    db: {\n        table: process.env.DB_TABLE_PAGE_BUILDER,\n        keys: [\n            {\n                primary: true,\n                unique: true,\n                name: \"primary\",\n                fields: [{ name: \"PK\" }, { name: \"SK\" }]\n            }\n        ]\n    },\n    esDb: {\n        table: process.env.DB_TABLE_ELASTICSEARCH,\n        keys: [\n            {\n                primary: true,\n                unique: true,\n                name: \"primary\",\n                fields: [{ name: \"PK\" }, { name: \"SK\" }]\n            }\n        ]\n    },\n    es(context: PbContext) {\n        const tenant = context.tenancy.getCurrentTenant();\n        if (!tenant) {\n            throw new Error(\"Tenant missing.\");\n        }\n\n        const sharedIndex = process.env.ELASTICSEARCH_SHARED_INDEXES === \"true\";\n        const index = `${sharedIndex ? \"root\" : tenant.id}-page-builder`;\n\n        const prefix = process.env.ELASTIC_SEARCH_INDEX_PREFIX;\n        if (prefix) {\n            return { index: prefix + index };\n        }\n        return { index };\n    }\n};\n"],"file":"defaults.js"}