{"version":3,"sources":["../../../../../src/admin/plugins/permissionRenderer/components/ContentEntryPermission.tsx"],"names":["React","useEffect","get","Grid","Cell","Typography","Select","i18n","Elevation","Checkbox","CheckboxGroup","Note","t","ns","pwOptions","id","name","ContentEntryPermission","Bind","data","entity","setValue","form","title","endpoints","length","onChangeFns","disabledPrimaryActions","undefined","includes","marginTop","padding","paddingBottom","value","cb","getValue","onChange","map"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport get from \"lodash/get\";\nimport { Grid, Cell } from \"@webiny/ui/Grid\";\nimport { Typography } from \"@webiny/ui/Typography\";\nimport { Select } from \"@webiny/ui/Select\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport { Elevation } from \"@webiny/ui/Elevation\";\nimport { Checkbox, CheckboxGroup } from \"@webiny/ui/Checkbox\";\nimport { Note } from \"./StyledComponents\";\n\nconst t = i18n.ns(\"app-headless-cms/admin/plugins/permissionRenderer\");\n\nconst pwOptions = [\n    { id: \"p\", name: t`Publish` },\n    { id: \"u\", name: t`Unpublish` },\n    { id: \"r\", name: t`Request review` },\n    { id: \"c\", name: t`Request changes` }\n];\n\nexport const ContentEntryPermission = ({ Bind, data, entity, setValue, form, title }) => {\n    // Set \"cms.contentEntry\" access scope to \"own\" if \"cms.contentModel\" === \"own\".\n    useEffect(() => {\n        if (\n            get(data, `contentModelAccessScope`) === \"own\" &&\n            get(data, `${entity}AccessScope`) !== \"own\"\n        ) {\n            setValue(`${entity}AccessScope`, \"own\");\n        }\n    }, [data]);\n\n    // Let's set default values for \"accessScopes\"\n    useEffect(() => {\n        if (\n            data.endpoints.length > 0 &&\n            !data[`${entity}AccessScope`] &&\n            form.onChangeFns[`${entity}AccessScope`]\n        ) {\n            setValue(`${entity}AccessScope`, \"full\");\n        }\n    }, [data, form]);\n\n    const disabledPrimaryActions =\n        [undefined, \"own\", \"no\"].includes(data[`${entity}AccessScope`]) ||\n        !data.endpoints.includes(\"manage\");\n\n    return (\n        <Elevation z={1} style={{ marginTop: 10 }}>\n            <Grid>\n                <Cell span={12}>\n                    <Typography use={\"overline\"}>{title}</Typography>\n                </Cell>\n                <Cell span={12}>\n                    <Grid style={{ padding: 0, paddingBottom: 24 }}>\n                        <Cell span={12}>\n                            <Bind\n                                name={`${entity}AccessScope`}\n                                beforeChange={(value, cb) => {\n                                    if (value === \"own\") {\n                                        setValue(`${entity}RWD`, \"rwd\");\n                                    }\n                                    cb(value);\n                                }}\n                            >\n                                <Select\n                                    label={t`Access Scope`}\n                                    disabled={data[`contentModelAccessScope`] === \"own\"}\n                                >\n                                    <option value={\"full\"}>{t`All entries`}</option>\n                                    {data.endpoints.includes(\"manage\") && (\n                                        <option\n                                            value={\"own\"}\n                                        >{t`Only entries created by the user`}</option>\n                                    )}\n                                </Select>\n                            </Bind>\n                            {data[`contentModelAccessScope`] === \"own\" && (\n                                <Note>\n                                    <Typography use={\"caption\"}>\n                                        <span className={\"highlight\"}>Content Entry</span>\n                                        &nbsp;{t`access depends upon`}&nbsp;\n                                        <span className={\"highlight\"}>Content Model</span>\n                                    </Typography>\n                                </Note>\n                            )}\n                        </Cell>\n\n                        <Cell span={12}>\n                            <Bind name={`${entity}RWD`}>\n                                <Select\n                                    label={t`Primary Actions`}\n                                    disabled={disabledPrimaryActions}\n                                >\n                                    <option value={\"r\"}>{t`Read`}</option>\n                                    {data.endpoints.includes(\"manage\") ? (\n                                        <option value={\"rw\"}>{t`Read, write`}</option>\n                                    ) : null}\n                                    {data.endpoints.includes(\"manage\") ? (\n                                        <option value={\"rwd\"}>{t`Read, write, delete`}</option>\n                                    ) : null}\n                                </Select>\n                            </Bind>\n                        </Cell>\n                        {data.endpoints.includes(\"manage\") ? (\n                            <Cell span={12}>\n                                <Bind name={`${entity}PW`}>\n                                    <CheckboxGroup\n                                        label={t`Publishing actions`}\n                                        description={t`Publishing-related actions that can be performed on content entries.`}\n                                    >\n                                        {({ getValue, onChange }) =>\n                                            pwOptions.map(({ id, name }) => (\n                                                <Checkbox\n                                                    disabled={[undefined, \"no\"].includes(\n                                                        data[`${entity}AccessScope`]\n                                                    )}\n                                                    key={id}\n                                                    label={name}\n                                                    value={getValue(id)}\n                                                    onChange={onChange(id)}\n                                                />\n                                            ))\n                                        }\n                                    </CheckboxGroup>\n                                </Bind>\n                            </Cell>\n                        ) : null}\n                    </Grid>\n                </Cell>\n            </Grid>\n        </Elevation>\n    );\n};\n"],"file":"ContentEntryPermission.js"}