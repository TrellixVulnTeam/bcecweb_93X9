{"version":3,"sources":["../../../../src/admin/components/ContentModelEditor/Editor.tsx"],"names":["React","useRef","useState","Prompt","styled","css","i18n","CircularProgress","LeftPanel","RightPanel","SplitView","Icon","Typography","Tab","Tabs","FieldsSidebar","FieldEditor","PreviewTab","Header","DragPreview","useContentModelEditor","t","ns","prompt","ContentContainer","paddingTop","EditContainer","padding","position","LeftBarTitle","borderBottom","display","alignItems","color","titleIcon","height","marginRight","LeftBarFieldList","overflow","formTabs","backgroundColor","Editor","data","setData","isPristine","tabsRef","activeTabIndex","setActiveTabIndex","onChange","fields","layout","current","switchTab","e"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from \"react\";\nimport { Prompt } from \"@webiny/react-router\";\nimport styled from \"@emotion/styled\";\nimport { css } from \"emotion\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport { CircularProgress } from \"@webiny/ui/Progress\";\nimport { LeftPanel, RightPanel, SplitView } from \"@webiny/app-admin/components/SplitView\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { Typography } from \"@webiny/ui/Typography\";\nimport { Tab, Tabs } from \"@webiny/ui/Tabs\";\nimport { ReactComponent as FormIcon } from \"./icons/round-assignment-24px.svg\";\nimport { FieldsSidebar } from \"./FieldsSidebar\";\nimport { FieldEditor } from \"../FieldEditor\";\nimport { PreviewTab } from \"./PreviewTab\";\nimport Header from \"./Header\";\nimport DragPreview from \"../DragPreview\";\nimport { useContentModelEditor } from \"./useContentModelEditor\";\n\nconst t = i18n.ns(\"app-headless-cms/admin/editor\");\n\nconst prompt = t`There are some unsaved changes! Are you sure you want to navigate away and discard all changes?`;\n\nconst ContentContainer = styled(\"div\")({\n    paddingTop: 65\n});\n\nexport const EditContainer = styled(\"div\")({\n    padding: 40,\n    position: \"relative\"\n});\n\nconst LeftBarTitle = styled(\"div\")({\n    borderBottom: \"1px solid var(--mdc-theme-on-background)\",\n    display: \"flex\",\n    alignItems: \"center\",\n    padding: 25,\n    color: \"var(--mdc-theme-on-surface)\"\n});\n\nconst titleIcon = css({\n    height: 24,\n    marginRight: 15,\n    color: \"var(--mdc-theme-primary)\"\n});\n\nconst LeftBarFieldList = styled(\"div\")({\n    padding: 40,\n    overflow: \"auto\",\n    height: \"calc(100vh - 250px)\"\n});\n\nconst formTabs = css({\n    \"&.webiny-ui-tabs\": {\n        \".webiny-ui-tabs__tab-bar\": {\n            backgroundColor: \"var(--mdc-theme-surface)\"\n        }\n    }\n});\n\nexport const Editor = () => {\n    const { data, setData, isPristine } = useContentModelEditor();\n\n    const tabsRef = useRef(null);\n    const [activeTabIndex, setActiveTabIndex] = useState(0);\n\n    const onChange = ({ fields, layout }) => {\n        setData(data => ({ ...data, fields, layout }));\n    };\n\n    if (!data) {\n        return <CircularProgress label={\"Loading content model...\"} />;\n    }\n\n    return (\n        <div className={\"content-model-editor\"}>\n            <Prompt when={!isPristine} message={prompt} />\n            <Header />\n            <ContentContainer>\n                <SplitView>\n                    <LeftPanel span={4}>\n                        <LeftBarTitle>\n                            <Icon className={titleIcon} icon={<FormIcon />} />\n                            <Typography use={\"headline6\"}>Fields</Typography>\n                        </LeftBarTitle>\n                        <LeftBarFieldList>\n                            <FieldsSidebar\n                                onFieldDragStart={() => {\n                                    if (tabsRef.current) {\n                                        tabsRef.current.switchTab(0);\n                                    }\n                                }}\n                            />\n                        </LeftBarFieldList>\n                    </LeftPanel>\n                    <RightPanel span={8}>\n                        <Tabs\n                            className={formTabs}\n                            ref={tabsRef}\n                            onActivate={e => setActiveTabIndex(e)}\n                        >\n                            <Tab label={\"Edit\"} data-testid={\"cms.editor.tab.edit\"}>\n                                <EditContainer>\n                                    <FieldEditor\n                                        fields={data.fields}\n                                        layout={data.layout}\n                                        onChange={onChange}\n                                    />\n                                </EditContainer>\n                            </Tab>\n                            <Tab label={\"Preview\"} data-testid={\"cms.editor.tab.preview\"}>\n                                <PreviewTab activeTab={activeTabIndex === 1} />\n                            </Tab>\n                        </Tabs>\n                    </RightPanel>\n                </SplitView>\n            </ContentContainer>\n            <DragPreview />\n        </div>\n    );\n};\n"],"file":"Editor.js"}