{"version":3,"sources":["../../../../../../../src/admin/views/contentEntries/ContentEntry/header/saveAndPublishContent/SaveAndPublishContent.tsx"],"names":["React","css","i18n","ButtonPrimary","useConfirmationDialog","useRevision","useContentEntry","usePermission","t","ns","buttonStyles","marginLeft","SaveAndPublishButton","form","loading","entry","revision","publishRevision","title","message","dataTestId","showConfirmation","canEdit","canPublish","current","submit","id"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,QAAoB,SAApB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,aAAT,QAA8B,mBAA9B;AACA,SAASC,qBAAT,QAAsC,+CAAtC;AACA,SAASC,WAAT;AACA,SAASC,eAAT;AACA,OAAOC,aAAP;AAGA,IAAMC,CAAC,GAAGN,IAAI,CAACO,EAAL,CAAQ,wEAAR,CAAV;AAEA,IAAMC,YAAY,gBAAGT,GAAG,CAAC;AACrBU,EAAAA,UAAU,EAAE;AADS,CAAD,wBAAxB;;AAIA,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,GAAM;AAC/B,yBAAiCN,eAAe,EAAhD;AAAA,MAAQO,IAAR,oBAAQA,IAAR;AAAA,MAAcC,OAAd,oBAAcA,OAAd;AAAA,MAAuBC,KAAvB,oBAAuBA,KAAvB;;AACA,qBAA4BV,WAAW,CAAC;AAAEW,IAAAA,QAAQ,EAAED;AAAZ,GAAD,CAAvC;AAAA,MAAQE,eAAR,gBAAQA,eAAR;;AAEA,8BAA6Bb,qBAAqB,CAAC;AAC/Cc,IAAAA,KAAK,EAAEV,CAAF,oFAD0C;AAE/CW,IAAAA,OAAO,eACH,+BAAIX,CAAJ,mJAH2C;AAK/CY,IAAAA,UAAU,EAAE;AALmC,GAAD,CAAlD;AAAA,MAAQC,gBAAR,yBAAQA,gBAAR;;AAQA,uBAAgCd,aAAa,EAA7C;AAAA,MAAQe,OAAR,kBAAQA,OAAR;AAAA,MAAiBC,UAAjB,kBAAiBA,UAAjB;;AAEA,MAAI,CAACD,OAAO,CAACP,KAAD,EAAQ,kBAAR,CAAR,IAAuC,CAACQ,UAAU,CAAC,kBAAD,CAAtD,EAA4E;AACxE,WAAO,IAAP;AACH;;AAED,sBACI,oBAAC,aAAD;AACI,IAAA,SAAS,EAAEb,YADf;AAEI,IAAA,OAAO,EAAE,mBAAM;AACXW,MAAAA,gBAAgB,wEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACQR,IAAI,CAACW,OAAL,CAAaC,MAAb,EADR;;AAAA;AACPV,gBAAAA,KADO;;AAAA,oBAERA,KAFQ;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,uBAKPE,eAAe,CAACF,KAAK,CAACW,EAAP,CALR;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAD,GAAhB;AAOH,KAVL;AAWI,IAAA,QAAQ,EAAEZ;AAXd,KAaKN,CAbL,sFADJ;AAiBH,CAnCD;;AAqCA,eAAeI,oBAAf","sourcesContent":["import React from \"react\";\nimport { css } from \"emotion\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport { useConfirmationDialog } from \"@webiny/app-admin/hooks/useConfirmationDialog\";\nimport { useRevision } from \"~/admin/views/contentEntries/ContentEntry/useRevision\";\nimport { useContentEntry } from \"~/admin/views/contentEntries/hooks/useContentEntry\";\nimport usePermission from \"~/admin/hooks/usePermission\";\nimport { CmsEditorContentEntry } from \"~/types\";\n\nconst t = i18n.ns(\"app-headless-cms/admin/plugins/content-details/header/publish-revision\");\n\nconst buttonStyles = css({\n    marginLeft: 16\n});\n\nconst SaveAndPublishButton = () => {\n    const { form, loading, entry } = useContentEntry();\n    const { publishRevision } = useRevision({ revision: entry });\n\n    const { showConfirmation } = useConfirmationDialog({\n        title: t`Publish content`,\n        message: (\n            <p>{t`You are about to publish a new revision. Are you sure you want to continue?`}</p>\n        ),\n        dataTestId: \"cms-confirm-save-and-publish\"\n    });\n\n    const { canEdit, canPublish } = usePermission();\n\n    if (!canEdit(entry, \"cms.contentEntry\") || !canPublish(\"cms.contentEntry\")) {\n        return null;\n    }\n\n    return (\n        <ButtonPrimary\n            className={buttonStyles}\n            onClick={() => {\n                showConfirmation(async () => {\n                    const entry = (await form.current.submit()) as CmsEditorContentEntry;\n                    if (!entry) {\n                        return;\n                    }\n                    await publishRevision(entry.id);\n                });\n            }}\n            disabled={loading}\n        >\n            {t`Save & Publish`}\n        </ButtonPrimary>\n    );\n};\n\nexport default SaveAndPublishButton;\n"],"file":"SaveAndPublishContent.js"}